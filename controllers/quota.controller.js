'use strict';const a8_0x25ea0b=a8_0x3b89;(function(_0x3c332c,_0x3e9c6){const _0x3f4769=a8_0x3b89,_0xa902f1=_0x3c332c();while(!![]){try{const _0x325a9d=-parseInt(_0x3f4769(0x1ec))/0x1*(-parseInt(_0x3f4769(0x21f))/0x2)+parseInt(_0x3f4769(0x21c))/0x3+parseInt(_0x3f4769(0x1ef))/0x4*(parseInt(_0x3f4769(0x1d9))/0x5)+parseInt(_0x3f4769(0x1df))/0x6+parseInt(_0x3f4769(0x1ea))/0x7+-parseInt(_0x3f4769(0x22d))/0x8*(parseInt(_0x3f4769(0x22c))/0x9)+-parseInt(_0x3f4769(0x215))/0xa;if(_0x325a9d===_0x3e9c6)break;else _0xa902f1['push'](_0xa902f1['shift']());}catch(_0xe09e15){_0xa902f1['push'](_0xa902f1['shift']());}}}(a8_0x794a,0xd44b0));var __awaiter=this&&this[a8_0x25ea0b(0x1fd)]||function(_0x5afc90,_0x42ced1,_0x32ee03,_0x5e1715){function _0x1fbb4f(_0xd091d6){return _0xd091d6 instanceof _0x32ee03?_0xd091d6:new _0x32ee03(function(_0x1a9abe){_0x1a9abe(_0xd091d6);});}return new(_0x32ee03||(_0x32ee03=Promise))(function(_0x470b0c,_0x15de45){const _0x228eac=a8_0x3b89;function _0x367c5b(_0x1d5506){try{_0x318013(_0x5e1715['next'](_0x1d5506));}catch(_0x3468c0){_0x15de45(_0x3468c0);}}function _0x17b014(_0x15841d){try{_0x318013(_0x5e1715['throw'](_0x15841d));}catch(_0x5d5f3b){_0x15de45(_0x5d5f3b);}}function _0x318013(_0x4b1798){const _0x212652=a8_0x3b89;_0x4b1798[_0x212652(0x1e5)]?_0x470b0c(_0x4b1798[_0x212652(0x1e1)]):_0x1fbb4f(_0x4b1798['value'])[_0x212652(0x1f2)](_0x367c5b,_0x17b014);}_0x318013((_0x5e1715=_0x5e1715[_0x228eac(0x1f3)](_0x5afc90,_0x42ced1||[]))[_0x228eac(0x1e8)]());});};Object[a8_0x25ea0b(0x1d7)](exports,a8_0x25ea0b(0x20c),{'value':!![]}),exports['restartQuota']=exports[a8_0x25ea0b(0x1d6)]=exports['deleteQuota']=exports[a8_0x25ea0b(0x1fb)]=exports[a8_0x25ea0b(0x204)]=exports[a8_0x25ea0b(0x222)]=void 0x0;const express_validator_1=require(a8_0x25ea0b(0x21d)),Quota_1=require(a8_0x25ea0b(0x20b)),Source_1=require(a8_0x25ea0b(0x22b)),Server_1=require(a8_0x25ea0b(0x223)),getQuotas=(_0x2bf6b6,_0x315ab1)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x45d122=a8_0x25ea0b;let _0x4d326c=yield Quota_1[_0x45d122(0x201)]['find']()[_0x45d122(0x1f2)](_0x16fd85=>{return _0x16fd85;})[_0x45d122(0x1eb)](_0x4210c1=>{const _0x97d6f9=_0x45d122;return{'errors':[{'location':_0x97d6f9(0x220),'msg':_0x97d6f9(0x1f8),'param':_0x97d6f9(0x22a)}]};});return _0x4d326c['sort']((_0x5c9327,_0x3c23bd)=>_0x3c23bd['isdefault']-_0x5c9327[_0x45d122(0x229)]),_0x315ab1[_0x45d122(0x1f5)](_0x4d326c);});function a8_0x3b89(_0x38d682,_0xd3bbea){const _0x794aaa=a8_0x794a();return a8_0x3b89=function(_0x3b89a6,_0x16ea88){_0x3b89a6=_0x3b89a6-0x1d4;let _0x30e044=_0x794aaa[_0x3b89a6];return _0x30e044;},a8_0x3b89(_0x38d682,_0xd3bbea);}exports['getQuotas']=getQuotas;const register=(_0x149cc6,_0x4a3560)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0xdb7173=a8_0x25ea0b;yield express_validator_1[_0xdb7173(0x208)](_0xdb7173(0x1e3))[_0xdb7173(0x227)]()[_0xdb7173(0x1e7)]('limit_empty')[_0xdb7173(0x221)](_0x149cc6),yield express_validator_1[_0xdb7173(0x208)]('type')[_0xdb7173(0x227)]()[_0xdb7173(0x1e7)](_0xdb7173(0x200))[_0xdb7173(0x221)](_0x149cc6);const _0x2e11e3=_0x1da44c=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0xb55062=_0xdb7173;return yield Quota_1[_0xb55062(0x201)]['findOne']({'limit':_0x149cc6[_0xb55062(0x22e)]['limit'],'type':_0x149cc6[_0xb55062(0x22e)][_0xb55062(0x21a)]})[_0xb55062(0x1f2)](_0x2e7d0f=>{const _0x17ff68=_0xb55062;if(_0x2e7d0f)return Promise[_0x17ff68(0x20f)](_0x17ff68(0x218));});});yield express_validator_1[_0xdb7173(0x208)](_0xdb7173(0x209))[_0xdb7173(0x1ee)](_0x2e11e3)[_0xdb7173(0x221)](_0x149cc6);const _0x21a7f5=express_validator_1[_0xdb7173(0x203)](_0x149cc6);if(!_0x21a7f5['isEmpty']())return _0x4a3560['json']({'errors':_0x21a7f5['array']()});let _0x12bc12=new Quota_1['QuotaInterface']({'limit':_0x149cc6[_0xdb7173(0x22e)]['limit'],'type':_0x149cc6[_0xdb7173(0x22e)]['type'],'isdefault':![]});return yield Quota_1[_0xdb7173(0x201)][_0xdb7173(0x1e0)](_0x12bc12,(_0x11909b,_0x358c62)=>{const _0x529026=_0xdb7173;if(_0x11909b)return _0x4a3560[_0x529026(0x1f5)]({'errors':[{'location':_0x529026(0x204),'msg':_0x529026(0x1f0)}]});else return _0x4a3560[_0x529026(0x1f5)](_0x358c62);});});function a8_0x794a(){const _0x2f2f90=['456XfIbSu','Lo\x20sentimos\x20no\x20se\x20pudo\x20registrar\x20la\x20cuota','Cuota\x20eliminada\x20de\x20por\x20defecto\x20correctamente','then','apply','Esta\x20cuota\x20ya\x20estÃ¡\x20establecidad\x20para\x20','json','restartQuota','findById','Lo\x20sentimos\x20no\x20se\x20pudieron\x20obtener\x20los\x20datos\x20de\x20las\x20cuotas','execPopulate','deleted','linkSource','Nada\x20que\x20hacer\x20con\x20la\x20cuota','__awaiter','delete','connection','type_empty','Quota','params','validationResult','register','Cuota\x20establecida\x20por\x20defecto\x20correctamente','collection','filter','check','host','identifier','../models/Quota','__esModule','quotaid','update','reject','deleteQuota','quotadeleted','find','findserver','self','15359800eeFRMa','sources','findByIdAndUpdate','Lo\x20sentimos\x20esta\x20cuota\x20ya\x20se\x20encuentra\x20registrada','nothingtodo','type','Lo\x20sentimos\x20no\x20se\x20pudo\x20eliminar\x20la\x20cuota','965826EBvPaI','express-validator','Esta\x20cuota\x20ya\x20es\x20la\x20cuota\x20por\x20defecto','222ccTIiZ','getServers','run','getQuotas','../models/Server','Cuota\x20establecida\x20correctamente','_id','length','notEmpty','Source','isdefault','servers','../models/Source','180YpwiYw','46744onknnw','body','save','updateOne','setDefault','defineProperty','Lo\x20sentimos\x20no\x20se\x20pudo\x20actualizar\x20la\x20cuota','39070uXMAXY','populate','quota','findOne','Lo\x20sentimos\x20no\x20se\x20pudieron\x20obtener\x20los\x20datos\x20de\x20la\x20cuota','map','5101350hQDiEp','create','value','Lo\x20sentimos\x20esta\x20cuota\x20no\x20se\x20encuentra\x20registrada','limit','nodefault','done','noquota','withMessage','next','Cuota\x20eliminada\x20correctamente','2999997txVrWA','catch','278llbXAV','Lo\x20sentimos\x20no\x20se\x20pudieron\x20obtener\x20los\x20datos\x20del\x20servidor','custom'];a8_0x794a=function(){return _0x2f2f90;};return a8_0x794a();}exports[a8_0x25ea0b(0x204)]=register;const linkSource=(_0x3876d2,_0xb02e73)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x4424bd=a8_0x25ea0b;Server_1['Server'][_0x4424bd(0x1dc)]({'host':_0x3876d2[_0x4424bd(0x22e)][_0x4424bd(0x209)]})[_0x4424bd(0x1da)](_0x4424bd(0x216))['then'](_0x375608=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x45af23=_0x4424bd;let _0x54cd72=_0x375608[_0x45af23(0x216)][_0x45af23(0x207)](function(_0x19be85){const _0x5bae9d=_0x45af23;return _0x19be85['identifier']==_0x3876d2[_0x5bae9d(0x22e)]['identifier'];})[0x0];if(_0x3876d2[_0x45af23(0x22e)][_0x45af23(0x20d)]==_0x45af23(0x1e6)){if(_0x54cd72[_0x45af23(0x1db)]!==undefined){yield _0x54cd72[_0x45af23(0x1da)](_0x45af23(0x1db))[_0x45af23(0x1f9)]();let _0x269925=yield _0x54cd72[_0x45af23(0x1db)][_0x45af23(0x1da)](_0x45af23(0x216))[_0x45af23(0x1f9)](),_0x360607=_0x269925[_0x45af23(0x216)][_0x45af23(0x207)](function(_0x4a86cd){const _0x4ef9d3=_0x45af23;return _0x4a86cd['identifier']!=_0x3876d2[_0x4ef9d3(0x22e)][_0x4ef9d3(0x20a)];});return _0x269925[_0x45af23(0x216)]=_0x360607,_0x269925[_0x45af23(0x1d4)](),yield Source_1[_0x45af23(0x228)][_0x45af23(0x206)][_0x45af23(0x1d5)]({'_id':_0x54cd72[_0x45af23(0x225)]},{'$unset':{'quota':0x1}}),_0xb02e73[_0x45af23(0x1f5)]({'status':_0x45af23(0x211),'msg':_0x45af23(0x1e9)});}else return _0xb02e73[_0x45af23(0x1f5)]({'status':'nothingtodo','msg':_0x45af23(0x1fc)});}else yield Quota_1[_0x45af23(0x201)][_0x45af23(0x1dc)]({'_id':_0x3876d2['body'][_0x45af23(0x20d)]})[_0x45af23(0x1da)](_0x45af23(0x216))[_0x45af23(0x1f2)](_0x108a60=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x4f62b9=_0x45af23;let _0x4b7d88=_0x108a60[_0x4f62b9(0x216)][_0x4f62b9(0x207)](function(_0x4eb432){const _0x1c1f6a=_0x4f62b9;return _0x4eb432['identifier']==_0x3876d2[_0x1c1f6a(0x22e)]['identifier'];});if(_0x4b7d88[_0x4f62b9(0x226)]>0x0)return _0xb02e73['json']({'errors':[{'location':_0x4f62b9(0x20e),'msg':_0x4f62b9(0x1f4)+_0x54cd72[_0x4f62b9(0x20a)]}]});else{if(_0x54cd72[_0x4f62b9(0x1db)]){yield _0x54cd72[_0x4f62b9(0x1da)]('quota')[_0x4f62b9(0x1f9)]();let _0x28db37=yield _0x54cd72[_0x4f62b9(0x1db)][_0x4f62b9(0x1da)]('sources')[_0x4f62b9(0x1f9)](),_0x5d9d21=_0x28db37[_0x4f62b9(0x216)]['filter'](function(_0x7a0ce2){const _0x355321=_0x4f62b9;return _0x7a0ce2['identifier']!=_0x3876d2[_0x355321(0x22e)][_0x355321(0x20a)];});_0x28db37['sources']=_0x5d9d21,_0x28db37['save']();}return _0x54cd72[_0x4f62b9(0x1db)]=_0x108a60['_id'],_0x54cd72['save'](),_0x108a60['sources']['push'](_0x54cd72),_0x108a60[_0x4f62b9(0x1d4)](),_0xb02e73['json']({'status':'ok','msg':_0x4f62b9(0x224)});}}))['catch'](_0x437ed3=>{const _0x1f7b62=_0x45af23;return _0xb02e73[_0x1f7b62(0x1f5)]({'errors':[{'location':_0x1f7b62(0x20e),'msg':_0x1f7b62(0x1dd),'param':'connection'}]});});}))['catch'](_0x21aefc=>{const _0x13cca6=_0x4424bd;return _0xb02e73[_0x13cca6(0x1f5)]({'errors':[{'location':_0x13cca6(0x20e),'msg':_0x13cca6(0x1ed),'param':_0x13cca6(0x1ff)}]});});});exports[a8_0x25ea0b(0x1fb)]=linkSource;const deleteQuota=(_0x3501ba,_0x372d12)=>{const _0x405065=a8_0x25ea0b;Quota_1[_0x405065(0x201)][_0x405065(0x1f7)](_0x3501ba[_0x405065(0x202)]['id'])[_0x405065(0x1da)]('sources')[_0x405065(0x1f2)](_0x54fbd9=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x113ccd=_0x405065;if(_0x54fbd9)_0x54fbd9[_0x113ccd(0x216)][_0x113ccd(0x1de)]((_0x59f90d,_0x557a52)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x2dfcfb=_0x113ccd;yield Source_1[_0x2dfcfb(0x228)][_0x2dfcfb(0x206)][_0x2dfcfb(0x1d5)]({'_id':_0x59f90d['_id']},{'$unset':{'quota':0x1}});})),Quota_1[_0x113ccd(0x201)]['findByIdAndDelete'](_0x3501ba[_0x113ccd(0x202)]['id'])[_0x113ccd(0x1f2)](()=>{return _0x372d12['json'](_0x54fbd9);})[_0x113ccd(0x1eb)](_0x5ee5fb=>{const _0x3d224c=_0x113ccd;return _0x372d12[_0x3d224c(0x1f5)]({'errors':[{'location':_0x3d224c(0x20e),'msg':_0x3d224c(0x21b),'param':_0x3d224c(0x1ff)}]});});else return _0x372d12[_0x113ccd(0x1f5)]({'errors':[{'location':_0x113ccd(0x1fe),'msg':_0x113ccd(0x1e2),'param':_0x113ccd(0x209)}]});}))[_0x405065(0x1eb)](_0x35e85e=>{const _0x5284b7=_0x405065;return _0x372d12['json']({'errors':[{'location':_0x5284b7(0x1fe),'msg':_0x5284b7(0x1dd),'param':'findserver'}]});});};exports[a8_0x25ea0b(0x210)]=deleteQuota;const setDefault=(_0x42f3a6,_0x47e420)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x3b81b7=a8_0x25ea0b;let _0x43fd68='';yield Quota_1[_0x3b81b7(0x201)][_0x3b81b7(0x1dc)]({'isdefault':!![]})[_0x3b81b7(0x1f2)](_0x483caf=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x16121f=_0x3b81b7;if(_0x483caf){if(_0x483caf[_0x16121f(0x225)]==_0x42f3a6[_0x16121f(0x202)]['id'])_0x43fd68=_0x16121f(0x214);else yield Quota_1['Quota'][_0x16121f(0x217)](_0x483caf[_0x16121f(0x225)],{'isdefault':![]},{'new':!![]}),_0x43fd68=_0x16121f(0x1fa);}}))['catch'](_0xa4928c=>{return _0x47e420['json']({'errors':[{'location':'update','msg':'Lo\x20sentimos\x20no\x20se\x20pudieron\x20obtener\x20los\x20datos\x20de\x20la\x20cuota'}]});});if(_0x43fd68==_0x3b81b7(0x214))return _0x47e420[_0x3b81b7(0x1f5)]({'errors':[{'location':_0x3b81b7(0x20e),'msg':_0x3b81b7(0x21e)}]});else{if(_0x42f3a6[_0x3b81b7(0x22e)][_0x3b81b7(0x20d)]!=_0x3b81b7(0x1e4))yield Quota_1[_0x3b81b7(0x201)][_0x3b81b7(0x1f7)](_0x42f3a6['params']['id'])[_0x3b81b7(0x1f2)](_0x40aa70=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x35c1f0=_0x3b81b7;if(_0x40aa70)yield Quota_1[_0x35c1f0(0x201)]['findByIdAndUpdate'](_0x42f3a6[_0x35c1f0(0x202)]['id'],{'isdefault':!![]},{'new':!![]})['then'](_0x55775d=>{const _0x4fac75=_0x35c1f0;return _0x47e420[_0x4fac75(0x1f5)]({'status':'updatedquota','msg':_0x4fac75(0x205)});})[_0x35c1f0(0x1eb)](_0x35621c=>{const _0x573d2e=_0x35c1f0;return _0x47e420[_0x573d2e(0x1f5)]({'errors':[{'location':_0x573d2e(0x20e),'msg':_0x573d2e(0x1d8),'param':_0x573d2e(0x1ff)}]});});else return _0x47e420[_0x35c1f0(0x1f5)]({'errors':[{'location':_0x35c1f0(0x1fe),'msg':_0x35c1f0(0x1e2),'param':_0x35c1f0(0x209)}]});}))[_0x3b81b7(0x1eb)](_0xdb2aa2=>{const _0x14d719=_0x3b81b7;return _0x47e420['json']({'errors':[{'location':_0x14d719(0x1fe),'msg':'Lo\x20sentimos\x20no\x20se\x20pudieron\x20obtener\x20los\x20datos\x20de\x20la\x20cuota','param':_0x14d719(0x213)}]});});else{if(_0x43fd68==_0x3b81b7(0x1fa))return _0x47e420[_0x3b81b7(0x1f5)]({'status':'deletedquota','msg':_0x3b81b7(0x1f1)});else return _0x47e420['json']({'status':_0x3b81b7(0x219),'msg':_0x3b81b7(0x1fc)});}}});exports[a8_0x25ea0b(0x1d6)]=setDefault;const restartQuota=_0x4c81a9=>{const _0x297154=a8_0x25ea0b;Quota_1[_0x297154(0x201)][_0x297154(0x212)]({'type':_0x4c81a9})[_0x297154(0x1da)](_0x297154(0x216))['then'](_0x35ce25=>{_0x35ce25['map']((_0x515e17,_0x508922)=>{const _0x1c62d8=a8_0x3b89;_0x515e17['sources'][_0x1c62d8(0x1de)]((_0x4202fb,_0x36d7a5)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0xe6b2e7=_0x1c62d8;yield Source_1[_0xe6b2e7(0x228)]['findByIdAndUpdate']({'_id':_0x4202fb['_id']},{'quota_consumed':0x0});}));});});};exports[a8_0x25ea0b(0x1f6)]=restartQuota;