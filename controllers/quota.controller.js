'use strict';const a45_0x172599=a45_0x1434;function a45_0x1434(_0x3c2193,_0x2b58d4){const _0x442562=a45_0x4425();return a45_0x1434=function(_0x1434c5,_0x91d17a){_0x1434c5=_0x1434c5-0x1cb;let _0x1d103f=_0x442562[_0x1434c5];return _0x1d103f;},a45_0x1434(_0x3c2193,_0x2b58d4);}(function(_0x17122d,_0x3b9c69){const _0x4b89ea=a45_0x1434,_0x59514d=_0x17122d();while(!![]){try{const _0x255992=parseInt(_0x4b89ea(0x206))/0x1+-parseInt(_0x4b89ea(0x1eb))/0x2+-parseInt(_0x4b89ea(0x1d0))/0x3+parseInt(_0x4b89ea(0x1fe))/0x4+parseInt(_0x4b89ea(0x1ee))/0x5+parseInt(_0x4b89ea(0x1ff))/0x6*(parseInt(_0x4b89ea(0x203))/0x7)+-parseInt(_0x4b89ea(0x212))/0x8;if(_0x255992===_0x3b9c69)break;else _0x59514d['push'](_0x59514d['shift']());}catch(_0x559d73){_0x59514d['push'](_0x59514d['shift']());}}}(a45_0x4425,0x767ee));var __awaiter=this&&this[a45_0x172599(0x21e)]||function(_0x30e767,_0x5d278b,_0x499c98,_0x2632a2){function _0x10b90c(_0x5ab1f1){return _0x5ab1f1 instanceof _0x499c98?_0x5ab1f1:new _0x499c98(function(_0x3ad039){_0x3ad039(_0x5ab1f1);});}return new(_0x499c98||(_0x499c98=Promise))(function(_0x3a28a0,_0x52ec2b){const _0x33462f=a45_0x1434;function _0x39c3b7(_0x5bb449){const _0x2a4f7c=a45_0x1434;try{_0x901679(_0x2632a2[_0x2a4f7c(0x214)](_0x5bb449));}catch(_0x2480c0){_0x52ec2b(_0x2480c0);}}function _0x35486b(_0xae41c7){const _0x593bc8=a45_0x1434;try{_0x901679(_0x2632a2[_0x593bc8(0x20c)](_0xae41c7));}catch(_0x4ce26f){_0x52ec2b(_0x4ce26f);}}function _0x901679(_0x2395a8){const _0x48b717=a45_0x1434;_0x2395a8[_0x48b717(0x1ce)]?_0x3a28a0(_0x2395a8[_0x48b717(0x1e6)]):_0x10b90c(_0x2395a8[_0x48b717(0x1e6)])['then'](_0x39c3b7,_0x35486b);}_0x901679((_0x2632a2=_0x2632a2[_0x33462f(0x1e8)](_0x30e767,_0x5d278b||[]))[_0x33462f(0x214)]());});};function a45_0x4425(){const _0x984cce=['limit_empty','Esta\x20cuota\x20ya\x20estÃ¡\x20establecidad\x20para\x20','check','self','array','__awaiter','validationResult','Nada\x20que\x20hacer\x20con\x20la\x20cuota','type_empty','servers','getServers','../models/Source','deleted','length','_id','notEmpty','done','findByIdAndDelete','1475325PnyBaG','linkSource','map','save','../models/Server','Lo\x20sentimos\x20no\x20se\x20pudo\x20registrar\x20la\x20cuota','Quota','custom','updatedquota','Server','findOne','run','limit','updateOne','isdefault','register','connection','findByIdAndUpdate','json','sources','withMessage','Source','value','Lo\x20sentimos\x20no\x20se\x20pudieron\x20obtener\x20los\x20datos\x20de\x20las\x20cuotas','apply','populate','create','540502hwOHOK','deleteQuota','noquota','1812485LRVwtZ','isEmpty','quotaid','identifier','nothingtodo','findserver','collection','catch','Lo\x20sentimos\x20esta\x20cuota\x20ya\x20se\x20encuentra\x20registrada','Lo\x20sentimos\x20esta\x20cuota\x20no\x20se\x20encuentra\x20registrada','__esModule','host','findById','update','then','../models/Quota','1587244WxAtgD','702KWVNeC','Cuota\x20eliminada\x20de\x20por\x20defecto\x20correctamente','defineProperty','Lo\x20sentimos\x20no\x20se\x20pudieron\x20obtener\x20los\x20datos\x20del\x20servidor','11501mvKDft','type','Lo\x20sentimos\x20no\x20se\x20pudo\x20actualizar\x20la\x20cuota','780588LHMJre','Lo\x20sentimos\x20no\x20se\x20pudo\x20eliminar\x20la\x20cuota','quota','restartQuota','filter','sort','throw','params','deletedquota','body','QuotaInterface','push','3877944ibRETb','Lo\x20sentimos\x20no\x20se\x20pudieron\x20obtener\x20los\x20datos\x20de\x20la\x20cuota','next','getQuotas','execPopulate','Esta\x20cuota\x20ya\x20es\x20la\x20cuota\x20por\x20defecto','delete'];a45_0x4425=function(){return _0x984cce;};return a45_0x4425();}Object[a45_0x172599(0x201)](exports,a45_0x172599(0x1f8),{'value':!![]}),exports['restartQuota']=exports['setDefault']=exports['deleteQuota']=exports[a45_0x172599(0x1d1)]=exports['register']=exports['getQuotas']=void 0x0;const express_validator_1=require('express-validator'),Quota_1=require(a45_0x172599(0x1fd)),Source_1=require(a45_0x172599(0x224)),Server_1=require(a45_0x172599(0x1d4)),getQuotas=(_0x190f1b,_0x2caead)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x4ef306=a45_0x172599;let _0x425435=yield Quota_1['Quota']['find']()[_0x4ef306(0x1fc)](_0x11ad20=>{return _0x11ad20;})[_0x4ef306(0x1f5)](_0x23ad5b=>{const _0x1566bc=_0x4ef306;return{'errors':[{'location':_0x1566bc(0x223),'msg':_0x1566bc(0x1e7),'param':_0x1566bc(0x222)}]};});return _0x425435[_0x4ef306(0x20b)]((_0x50e465,_0x5fdb36)=>_0x5fdb36[_0x4ef306(0x1de)]-_0x50e465[_0x4ef306(0x1de)]),_0x2caead[_0x4ef306(0x1e2)](_0x425435);});exports[a45_0x172599(0x215)]=getQuotas;const register=(_0x4c541c,_0x5beab7)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x504b0f=a45_0x172599;yield express_validator_1[_0x504b0f(0x21b)](_0x504b0f(0x1dc))[_0x504b0f(0x1cd)]()[_0x504b0f(0x1e4)](_0x504b0f(0x219))[_0x504b0f(0x1db)](_0x4c541c),yield express_validator_1[_0x504b0f(0x21b)](_0x504b0f(0x204))[_0x504b0f(0x1cd)]()['withMessage'](_0x504b0f(0x221))[_0x504b0f(0x1db)](_0x4c541c);const _0x26b720=_0x45ead9=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x8b0473=_0x504b0f;return yield Quota_1[_0x8b0473(0x1d6)][_0x8b0473(0x1da)]({'limit':_0x4c541c[_0x8b0473(0x20f)]['limit'],'type':_0x4c541c[_0x8b0473(0x20f)]['type']})[_0x8b0473(0x1fc)](_0x5e564f=>{const _0x1dd483=_0x8b0473;if(_0x5e564f)return Promise['reject'](_0x1dd483(0x1f6));});});yield express_validator_1['check'](_0x504b0f(0x1f9))[_0x504b0f(0x1d7)](_0x26b720)[_0x504b0f(0x1db)](_0x4c541c);const _0x38f30b=express_validator_1[_0x504b0f(0x21f)](_0x4c541c);if(!_0x38f30b[_0x504b0f(0x1ef)]())return _0x5beab7[_0x504b0f(0x1e2)]({'errors':_0x38f30b[_0x504b0f(0x21d)]()});let _0x87862b=new Quota_1[(_0x504b0f(0x210))]({'limit':_0x4c541c[_0x504b0f(0x20f)][_0x504b0f(0x1dc)],'type':_0x4c541c[_0x504b0f(0x20f)][_0x504b0f(0x204)],'isdefault':![]});return yield Quota_1[_0x504b0f(0x1d6)][_0x504b0f(0x1ea)](_0x87862b,(_0x1c22fe,_0x42be04)=>{const _0x43becf=_0x504b0f;if(_0x1c22fe)return _0x5beab7['json']({'errors':[{'location':_0x43becf(0x1df),'msg':_0x43becf(0x1d5)}]});else return _0x5beab7[_0x43becf(0x1e2)](_0x42be04);});});exports['register']=register;const linkSource=(_0x3abd6c,_0x55a7b9)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x254b8f=a45_0x172599;Server_1[_0x254b8f(0x1d9)][_0x254b8f(0x1da)]({'host':_0x3abd6c[_0x254b8f(0x20f)][_0x254b8f(0x1f9)]})['populate']('sources')[_0x254b8f(0x1fc)](_0x2c29ac=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x18c224=_0x254b8f;let _0x29648e=_0x2c29ac[_0x18c224(0x1e3)][_0x18c224(0x20a)](function(_0xb9ee45){const _0x3ee367=_0x18c224;return _0xb9ee45[_0x3ee367(0x1f1)]==_0x3abd6c[_0x3ee367(0x20f)][_0x3ee367(0x1f1)];})[0x0];if(_0x3abd6c['body'][_0x18c224(0x1f0)]==_0x18c224(0x1ed)){if(_0x29648e[_0x18c224(0x208)]!==undefined){yield _0x29648e[_0x18c224(0x1e9)](_0x18c224(0x208))[_0x18c224(0x216)]();let _0x4373b6=yield _0x29648e[_0x18c224(0x208)][_0x18c224(0x1e9)](_0x18c224(0x1e3))['execPopulate'](),_0x775be1=_0x4373b6[_0x18c224(0x1e3)][_0x18c224(0x20a)](function(_0x10ad39){const _0x3bc180=_0x18c224;return _0x10ad39[_0x3bc180(0x1f1)]!=_0x3abd6c[_0x3bc180(0x20f)][_0x3bc180(0x1f1)];});return _0x4373b6[_0x18c224(0x1e3)]=_0x775be1,_0x4373b6[_0x18c224(0x1d3)](),yield Source_1[_0x18c224(0x1e5)][_0x18c224(0x1f4)]['updateOne']({'_id':_0x29648e[_0x18c224(0x1cc)]},{'$unset':{'quota':0x1}}),_0x55a7b9[_0x18c224(0x1e2)]({'status':'quotadeleted','msg':'Cuota\x20eliminada\x20correctamente'});}else return _0x55a7b9[_0x18c224(0x1e2)]({'status':'nothingtodo','msg':_0x18c224(0x220)});}else yield Quota_1['Quota'][_0x18c224(0x1da)]({'_id':_0x3abd6c[_0x18c224(0x20f)][_0x18c224(0x1f0)]})['populate']('sources')[_0x18c224(0x1fc)](_0x19f40a=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0xd88cf1=_0x18c224;let _0x379d54=_0x19f40a[_0xd88cf1(0x1e3)][_0xd88cf1(0x20a)](function(_0x1ae30f){const _0x3fd0d7=_0xd88cf1;return _0x1ae30f['identifier']==_0x3abd6c['body'][_0x3fd0d7(0x1f1)];});if(_0x379d54[_0xd88cf1(0x1cb)]>0x0)return _0x55a7b9[_0xd88cf1(0x1e2)]({'errors':[{'location':_0xd88cf1(0x1fb),'msg':_0xd88cf1(0x21a)+_0x29648e[_0xd88cf1(0x1f1)]}]});else{if(_0x29648e[_0xd88cf1(0x208)]){yield _0x29648e[_0xd88cf1(0x1e9)](_0xd88cf1(0x208))[_0xd88cf1(0x216)]();let _0x2c9fd6=yield _0x29648e[_0xd88cf1(0x208)][_0xd88cf1(0x1e9)](_0xd88cf1(0x1e3))[_0xd88cf1(0x216)](),_0x4c4687=_0x2c9fd6[_0xd88cf1(0x1e3)][_0xd88cf1(0x20a)](function(_0x43410a){const _0x2403f0=_0xd88cf1;return _0x43410a[_0x2403f0(0x1f1)]!=_0x3abd6c[_0x2403f0(0x20f)][_0x2403f0(0x1f1)];});_0x2c9fd6[_0xd88cf1(0x1e3)]=_0x4c4687,_0x2c9fd6[_0xd88cf1(0x1d3)]();}return _0x29648e[_0xd88cf1(0x208)]=_0x19f40a[_0xd88cf1(0x1cc)],_0x29648e[_0xd88cf1(0x1d3)](),_0x19f40a[_0xd88cf1(0x1e3)][_0xd88cf1(0x211)](_0x29648e),_0x19f40a['save'](),_0x55a7b9[_0xd88cf1(0x1e2)]({'status':'ok','msg':'Cuota\x20establecida\x20correctamente'});}}))[_0x18c224(0x1f5)](_0x52de21=>{const _0x3000d1=_0x18c224;return _0x55a7b9['json']({'errors':[{'location':'update','msg':_0x3000d1(0x213),'param':_0x3000d1(0x1e0)}]});});}))[_0x254b8f(0x1f5)](_0xeed3aa=>{const _0x12d811=_0x254b8f;return _0x55a7b9[_0x12d811(0x1e2)]({'errors':[{'location':_0x12d811(0x1fb),'msg':_0x12d811(0x202),'param':'connection'}]});});});exports['linkSource']=linkSource;const deleteQuota=(_0x87dfa4,_0x44a235)=>{const _0x2a610f=a45_0x172599;Quota_1[_0x2a610f(0x1d6)][_0x2a610f(0x1fa)](_0x87dfa4[_0x2a610f(0x20d)]['id'])['populate'](_0x2a610f(0x1e3))[_0x2a610f(0x1fc)](_0x143ffc=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0xf7d592=_0x2a610f;if(_0x143ffc)_0x143ffc[_0xf7d592(0x1e3)]['map']((_0x267fe9,_0x588be6)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x768564=_0xf7d592;yield Source_1['Source'][_0x768564(0x1f4)][_0x768564(0x1dd)]({'_id':_0x267fe9[_0x768564(0x1cc)]},{'$unset':{'quota':0x1}});})),Quota_1[_0xf7d592(0x1d6)][_0xf7d592(0x1cf)](_0x87dfa4[_0xf7d592(0x20d)]['id'])[_0xf7d592(0x1fc)](()=>{const _0x1a6e72=_0xf7d592;return _0x44a235[_0x1a6e72(0x1e2)](_0x143ffc);})[_0xf7d592(0x1f5)](_0x4ea159=>{const _0x2f84eb=_0xf7d592;return _0x44a235[_0x2f84eb(0x1e2)]({'errors':[{'location':_0x2f84eb(0x1fb),'msg':_0x2f84eb(0x207),'param':_0x2f84eb(0x1e0)}]});});else return _0x44a235[_0xf7d592(0x1e2)]({'errors':[{'location':_0xf7d592(0x218),'msg':'Lo\x20sentimos\x20esta\x20cuota\x20no\x20se\x20encuentra\x20registrada','param':_0xf7d592(0x1f9)}]});}))[_0x2a610f(0x1f5)](_0x2d4149=>{const _0x3881aa=_0x2a610f;return _0x44a235[_0x3881aa(0x1e2)]({'errors':[{'location':'delete','msg':_0x3881aa(0x213),'param':'findserver'}]});});};exports[a45_0x172599(0x1ec)]=deleteQuota;const setDefault=(_0x50fdc8,_0x2d5bb2)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x47d2b4=a45_0x172599;let _0xf10336='';yield Quota_1[_0x47d2b4(0x1d6)][_0x47d2b4(0x1da)]({'isdefault':!![]})['then'](_0x329a81=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x1e4cd0=_0x47d2b4;if(_0x329a81){if(_0x329a81[_0x1e4cd0(0x1cc)]==_0x50fdc8['params']['id'])_0xf10336=_0x1e4cd0(0x21c);else yield Quota_1['Quota']['findByIdAndUpdate'](_0x329a81[_0x1e4cd0(0x1cc)],{'isdefault':![]},{'new':!![]}),_0xf10336='deleted';}}))[_0x47d2b4(0x1f5)](_0x258eb6=>{const _0x5ae445=_0x47d2b4;return _0x2d5bb2[_0x5ae445(0x1e2)]({'errors':[{'location':'update','msg':_0x5ae445(0x213)}]});});if(_0xf10336=='self')return _0x2d5bb2[_0x47d2b4(0x1e2)]({'errors':[{'location':_0x47d2b4(0x1fb),'msg':_0x47d2b4(0x217)}]});else{if(_0x50fdc8[_0x47d2b4(0x20f)]['quotaid']!='nodefault')yield Quota_1['Quota'][_0x47d2b4(0x1fa)](_0x50fdc8['params']['id'])[_0x47d2b4(0x1fc)](_0x51b486=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x145364=_0x47d2b4;if(_0x51b486)yield Quota_1[_0x145364(0x1d6)]['findByIdAndUpdate'](_0x50fdc8['params']['id'],{'isdefault':!![]},{'new':!![]})[_0x145364(0x1fc)](_0x21f897=>{const _0x35f74e=_0x145364;return _0x2d5bb2['json']({'status':_0x35f74e(0x1d8),'msg':'Cuota\x20establecida\x20por\x20defecto\x20correctamente'});})[_0x145364(0x1f5)](_0x5ee6bc=>{const _0x121258=_0x145364;return _0x2d5bb2[_0x121258(0x1e2)]({'errors':[{'location':_0x121258(0x1fb),'msg':_0x121258(0x205),'param':_0x121258(0x1e0)}]});});else return _0x2d5bb2[_0x145364(0x1e2)]({'errors':[{'location':_0x145364(0x218),'msg':_0x145364(0x1f7),'param':_0x145364(0x1f9)}]});}))[_0x47d2b4(0x1f5)](_0x8daa0e=>{const _0x19ebd3=_0x47d2b4;return _0x2d5bb2[_0x19ebd3(0x1e2)]({'errors':[{'location':_0x19ebd3(0x218),'msg':_0x19ebd3(0x213),'param':_0x19ebd3(0x1f3)}]});});else{if(_0xf10336==_0x47d2b4(0x225))return _0x2d5bb2['json']({'status':_0x47d2b4(0x20e),'msg':_0x47d2b4(0x200)});else return _0x2d5bb2[_0x47d2b4(0x1e2)]({'status':_0x47d2b4(0x1f2),'msg':'Nada\x20que\x20hacer\x20con\x20la\x20cuota'});}}});exports['setDefault']=setDefault;const restartQuota=_0x2b148c=>{const _0x5622f6=a45_0x172599;Quota_1['Quota']['find']({'type':_0x2b148c})['populate'](_0x5622f6(0x1e3))[_0x5622f6(0x1fc)](_0x46c4a3=>{const _0x191f3d=_0x5622f6;_0x46c4a3[_0x191f3d(0x1d2)]((_0x4aa104,_0x48ee19)=>{const _0x257c17=_0x191f3d;_0x4aa104[_0x257c17(0x1e3)]['map']((_0xa1c156,_0x5d80a3)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x51ca61=_0x257c17;yield Source_1[_0x51ca61(0x1e5)][_0x51ca61(0x1e1)]({'_id':_0xa1c156[_0x51ca61(0x1cc)]},{'quota_consumed':0x0});}));});});};exports[a45_0x172599(0x209)]=restartQuota;