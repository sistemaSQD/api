'use strict';const a83_0x2e85fd=a83_0xaae6;(function(_0x409c14,_0x2a122b){const _0x37f6db=a83_0xaae6,_0x3f81f3=_0x409c14();while(!![]){try{const _0xd98ab0=-parseInt(_0x37f6db(0x223))/0x1*(-parseInt(_0x37f6db(0x207))/0x2)+-parseInt(_0x37f6db(0x22f))/0x3*(parseInt(_0x37f6db(0x1d8))/0x4)+-parseInt(_0x37f6db(0x205))/0x5+parseInt(_0x37f6db(0x22d))/0x6+-parseInt(_0x37f6db(0x1e2))/0x7+-parseInt(_0x37f6db(0x1fe))/0x8*(-parseInt(_0x37f6db(0x211))/0x9)+-parseInt(_0x37f6db(0x204))/0xa;if(_0xd98ab0===_0x2a122b)break;else _0x3f81f3['push'](_0x3f81f3['shift']());}catch(_0x9b4943){_0x3f81f3['push'](_0x3f81f3['shift']());}}}(a83_0x5b59,0x26206));function a83_0x5b59(){const _0xe79a7f=['Lo\x20sentimos\x20no\x20se\x20pudo\x20registrar\x20el\x20servidor\x20LDAP','error','searchEntry','next','bind','port','map','Lo\x20sentimos\x20no\x20se\x20pudieron\x20obtener\x20los\x20datos\x20del\x20servidor\x20proxy','639828DozlTt','createClient','array','then','delete','Lo\x20sentimos\x20no\x20se\x20pudo\x20eliminar\x20el\x20servidor\x20LDAP','save','reject','throw','Lo\x20sentimos\x20el\x20servidor\x20proxy\x20ya\x20está\x20vinculado\x20a\x20este\x20servidor\x20LDAP','Server','proxyid','error:\x20','linkProxyServer','Lo\x20sentimos\x20no\x20se\x20pudieron\x20obtener\x20los\x20datos\x20del\x20servidor\x20LDAP','find\x20ldap\x20server','run','findById','value','__awaiter','express-validator','Nada\x20que\x20hacer\x20con\x20el\x20servidor\x20ldap','__esModule','update','object','host_not_is_ip','auth\x20ldap\x20server','collection','179736qMTRFL','Lo\x20sentimos\x20el\x20Dn\x20Base\x20es\x20incorrecto','proxyservers','params','dnbase','sub','1130160daerGf','906120SSigxK','json','218IrZMdj','encryption','find','host','unbind','nothingtodo','search','servers','serverldap','populate','72dfKIEv','status','El\x20vinculo\x20ha\x20sido\x20realizado\x20correctamente','_id','samaccountname=','find\x20proxy\x20server','ServerLdap','custom','ldapid','Lo\x20sentimos\x20este\x20servidor\x20LDAP\x20no\x20se\x20encuentra\x20registrado','validationResult','Lo\x20sentimos\x20los\x20datos\x20de\x20autenticación\x20son\x20incorrectos','ServerLdapInterface','host_found','message','notEmpty','apply','savedserver','2034OYLVWc','getSourceInfo','deleteServer','execPopulate','noldapserver','Lo\x20sentimos\x20el\x20servidor\x20proxy\x20no\x20tiene\x20ningún\x20servidor\x20LDAP\x20asociado','body','isEmpty','Lo\x20sentimos\x20no\x20se\x20pudieron\x20obtener\x20los\x20datos\x20de\x20los\x20servidores\x20LDAP','ldap://','1229136oNMeMt','catch','36SYXOsc','push','ldapjs','check','destroy','Lo\x20sentimos\x20no\x20se\x20pudo\x20encontrar\x20ninguna\x20entidad\x20en\x20el\x20servidor\x20LDAP','dnuser','updateOne','filter','password','findByIdAndDelete','host_empty','create','source','register','21496VTnhoa','Servidor\x20LDAP\x20eliminado\x20correctamente'];a83_0x5b59=function(){return _0xe79a7f;};return a83_0x5b59();}var __awaiter=this&&this[a83_0x2e85fd(0x1f5)]||function(_0x1009d7,_0x520c25,_0x2a1258,_0x274f22){function _0x2480f4(_0x2e6903){return _0x2e6903 instanceof _0x2a1258?_0x2e6903:new _0x2a1258(function(_0x3c9a07){_0x3c9a07(_0x2e6903);});}return new(_0x2a1258||(_0x2a1258=Promise))(function(_0x3886ab,_0x6c1987){const _0x40a5ea=a83_0xaae6;function _0x40e865(_0x292a8d){const _0x3828f4=a83_0xaae6;try{_0x278227(_0x274f22[_0x3828f4(0x1dd)](_0x292a8d));}catch(_0x368b9d){_0x6c1987(_0x368b9d);}}function _0x571d32(_0x104e44){const _0x378cbc=a83_0xaae6;try{_0x278227(_0x274f22[_0x378cbc(0x1ea)](_0x104e44));}catch(_0x52b257){_0x6c1987(_0x52b257);}}function _0x278227(_0x21ff47){const _0x4f11d0=a83_0xaae6;_0x21ff47['done']?_0x3886ab(_0x21ff47[_0x4f11d0(0x1f4)]):_0x2480f4(_0x21ff47['value'])[_0x4f11d0(0x1e5)](_0x40e865,_0x571d32);}_0x278227((_0x274f22=_0x274f22[_0x40a5ea(0x221)](_0x1009d7,_0x520c25||[]))[_0x40a5ea(0x1dd)]());});};Object['defineProperty'](exports,a83_0x2e85fd(0x1f8),{'value':!![]}),exports[a83_0x2e85fd(0x225)]=exports[a83_0x2e85fd(0x224)]=exports[a83_0x2e85fd(0x1ef)]=exports[a83_0x2e85fd(0x1d7)]=exports['getLdapServers']=void 0x0;const express_validator_1=require(a83_0x2e85fd(0x1f6)),ServerLdap_1=require('../models/ServerLdap'),Server_1=require('../models/Server'),ldap=require(a83_0x2e85fd(0x231)),getLdapServers=(_0x5d5b2b,_0x53db52)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x3b50a8=a83_0x2e85fd;let _0x5a9259=yield ServerLdap_1[_0x3b50a8(0x217)][_0x3b50a8(0x209)]()['then'](_0x3ea95d=>{return _0x3ea95d;})[_0x3b50a8(0x22e)](_0x50212f=>{const _0x21dfc7=_0x3b50a8;return{'errors':[{'location':'getLdapServers','msg':_0x21dfc7(0x22b),'param':'servers'}]};});return _0x53db52['json'](_0x5a9259);});exports['getLdapServers']=getLdapServers;const register=(_0x6bc25d,_0x5c413e)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x257615=a83_0x2e85fd;yield express_validator_1['check'](_0x257615(0x20a))[_0x257615(0x220)]()['withMessage'](_0x257615(0x23a))[_0x257615(0x1f2)](_0x6bc25d);const _0x418917=_0x138921=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x28f866=_0x257615;if(!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/['test'](_0x6bc25d[_0x28f866(0x229)][_0x28f866(0x20a)]))return Promise[_0x28f866(0x1e9)](_0x28f866(0x1fb));}),_0x15e636=_0x1c238f=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x50e4db=_0x257615;return yield ServerLdap_1[_0x50e4db(0x217)]['findOne']({'host':_0x6bc25d[_0x50e4db(0x229)]['host']})['then'](_0x4a4083=>{const _0x3f0468=_0x50e4db;if(_0x4a4083)return Promise[_0x3f0468(0x1e9)](_0x3f0468(0x21e));});});yield express_validator_1['check'](_0x257615(0x20a))[_0x257615(0x218)](_0x418917)[_0x257615(0x1f2)](_0x6bc25d),yield express_validator_1[_0x257615(0x232)](_0x257615(0x20a))[_0x257615(0x218)](_0x15e636)[_0x257615(0x1f2)](_0x6bc25d);const _0x1da18c=express_validator_1[_0x257615(0x21b)](_0x6bc25d);if(!_0x1da18c[_0x257615(0x22a)]())return _0x5c413e[_0x257615(0x212)](0x190)['json']({'errors':_0x1da18c[_0x257615(0x1e4)]()});const _0x3a9c96=ldap['createClient']({'url':['ldap://'+_0x6bc25d[_0x257615(0x229)][_0x257615(0x20a)]+':'+_0x6bc25d[_0x257615(0x229)]['port']],'reconnect':!![]});yield _0x3a9c96[_0x257615(0x1de)](_0x6bc25d[_0x257615(0x229)][_0x257615(0x235)],_0x6bc25d[_0x257615(0x229)][_0x257615(0x238)],_0x3e803d=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x2b0081=_0x257615;if(_0x3e803d)return _0x5c413e[_0x2b0081(0x206)]({'errors':[{'location':_0x2b0081(0x1d7),'msg':_0x2b0081(0x21c),'param':_0x2b0081(0x222)}]});else yield _0x3a9c96[_0x2b0081(0x20d)](_0x6bc25d[_0x2b0081(0x229)][_0x2b0081(0x202)],{},function(_0x25915b,_0x51a589){const _0x39933d=_0x2b0081;if(_0x25915b)return _0x5c413e['json']({'errors':[{'location':_0x39933d(0x1d7),'msg':_0x39933d(0x1ff),'param':_0x39933d(0x222)}]});else _0x51a589['on'](_0x39933d(0x1dc),function(_0x5d2ea0){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x59ba09=a83_0xaae6;let _0x50623b=new ServerLdap_1[(_0x59ba09(0x21d))]({'host':_0x6bc25d['body'][_0x59ba09(0x20a)],'port':_0x6bc25d[_0x59ba09(0x229)]['port'],'dnbase':_0x6bc25d[_0x59ba09(0x229)]['dnbase'],'dnuser':_0x6bc25d[_0x59ba09(0x229)]['dnuser'],'encryption':_0x6bc25d[_0x59ba09(0x229)][_0x59ba09(0x208)],'password':_0x6bc25d['body'][_0x59ba09(0x238)]});return yield ServerLdap_1['ServerLdap'][_0x59ba09(0x23b)](_0x50623b,(_0x2c3e0e,_0x1ddaf9)=>{const _0x290278=_0x59ba09;if(_0x2c3e0e)return _0x5c413e[_0x290278(0x206)]({'errors':[{'location':_0x290278(0x1d7),'msg':_0x290278(0x1da),'param':_0x290278(0x222)}]});else return _0x5c413e[_0x290278(0x206)](_0x1ddaf9);});});}),_0x51a589['on'](_0x39933d(0x1db),function(_0xd5c49a){const _0x5ba839=_0x39933d;return console[_0x5ba839(0x1db)](_0x5ba839(0x1ee)+_0xd5c49a[_0x5ba839(0x21f)]),_0x5c413e[_0x5ba839(0x206)]({'errors':[{'location':_0x5ba839(0x1d7),'msg':_0x5ba839(0x234),'param':'savedserver'}]});});});}));});exports[a83_0x2e85fd(0x1d7)]=register;const linkProxyServer=(_0x30eab3,_0x231e48)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x2056aa=a83_0x2e85fd;yield ServerLdap_1[_0x2056aa(0x217)]['findById'](_0x30eab3[_0x2056aa(0x229)][_0x2056aa(0x219)])[_0x2056aa(0x210)](_0x2056aa(0x200))[_0x2056aa(0x1e5)](_0x7888dc=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x288a86=_0x2056aa;yield Server_1[_0x288a86(0x1ec)][_0x288a86(0x1f3)](_0x30eab3['body'][_0x288a86(0x1ed)])[_0x288a86(0x210)](_0x288a86(0x20f))[_0x288a86(0x1e5)](_0x4ea33d=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0xc36bb6=_0x288a86;if(_0x30eab3['body'][_0xc36bb6(0x219)]==_0xc36bb6(0x227)){if(_0x4ea33d[_0xc36bb6(0x20f)]!==undefined){let _0x350e1d=yield _0x4ea33d['serverldap'][_0xc36bb6(0x210)](_0xc36bb6(0x200))[_0xc36bb6(0x226)](),_0x2a9114=_0x350e1d['proxyservers'][_0xc36bb6(0x237)](function(_0x1c1a6f){const _0x1c38a9=_0xc36bb6;return _0x1c1a6f['host']!=_0x4ea33d[_0x1c38a9(0x20a)];});return _0x350e1d['proxyservers']=_0x2a9114,_0x350e1d[_0xc36bb6(0x1e8)](),yield Server_1[_0xc36bb6(0x1ec)][_0xc36bb6(0x1fd)][_0xc36bb6(0x236)]({'_id':_0x4ea33d[_0xc36bb6(0x214)]},{'$unset':{'serverldap':0x1}}),_0x231e48[_0xc36bb6(0x206)]({'status':'serverldapdeleted','msg':_0xc36bb6(0x1d9)});}else return _0x231e48[_0xc36bb6(0x206)]({'status':_0xc36bb6(0x20c),'msg':_0xc36bb6(0x1f7)});}else{let _0x3cfd06=_0x7888dc[_0xc36bb6(0x200)][_0xc36bb6(0x237)](function(_0x3c4523){const _0x19a906=_0xc36bb6;return _0x3c4523[_0x19a906(0x20a)]==_0x4ea33d[_0x19a906(0x20a)];});if(_0x3cfd06['length']>0x0)return _0x231e48[_0xc36bb6(0x206)]({'errors':[{'location':_0xc36bb6(0x1f9),'msg':_0xc36bb6(0x1eb)}]});else{if(_0x4ea33d[_0xc36bb6(0x20f)]){let _0x4a46dc=yield _0x4ea33d[_0xc36bb6(0x20f)][_0xc36bb6(0x210)]('proxyservers')[_0xc36bb6(0x226)](),_0x2f901d=_0x4a46dc[_0xc36bb6(0x200)][_0xc36bb6(0x237)](function(_0x37b1f9){const _0x2406d4=_0xc36bb6;return _0x37b1f9[_0x2406d4(0x20a)]!=_0x4ea33d[_0x2406d4(0x20a)];});_0x4a46dc[_0xc36bb6(0x200)]=_0x2f901d,_0x4a46dc[_0xc36bb6(0x1e8)]();}return _0x4ea33d['serverldap']=_0x7888dc[_0xc36bb6(0x214)],_0x4ea33d[_0xc36bb6(0x1e8)](),_0x7888dc[_0xc36bb6(0x200)][_0xc36bb6(0x230)](_0x4ea33d),_0x7888dc['save'](),_0x231e48[_0xc36bb6(0x206)]({'status':'ok','msg':_0xc36bb6(0x213)});}}}))[_0x288a86(0x22e)](_0x55918d=>{const _0x139343=_0x288a86;return _0x231e48['json']({'errors':[{'location':_0x139343(0x216),'msg':_0x139343(0x1e1),'param':_0x139343(0x20e)}]});});}))['catch'](_0x50a851=>{const _0x16f93f=_0x2056aa;return _0x231e48[_0x16f93f(0x206)]({'errors':[{'location':_0x16f93f(0x1f1),'msg':_0x16f93f(0x1f0),'param':_0x16f93f(0x20e)}]});});});exports[a83_0x2e85fd(0x1ef)]=linkProxyServer;const getSourceInfo=(_0x194281,_0x111bde)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x553480=a83_0x2e85fd;yield Server_1[_0x553480(0x1ec)]['findOne']({'host':_0x194281[_0x553480(0x229)]['host']})[_0x553480(0x210)](_0x553480(0x20f))['then'](_0x221fd0=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x129a02=_0x553480;if(_0x221fd0){if(_0x221fd0[_0x129a02(0x20f)]){const _0xcda37c=ldap[_0x129a02(0x1e3)]({'url':[_0x129a02(0x22c)+_0x221fd0[_0x129a02(0x20f)][_0x129a02(0x20a)]+':'+_0x221fd0['serverldap'][_0x129a02(0x1df)]]});yield _0xcda37c[_0x129a02(0x1de)](_0x221fd0[_0x129a02(0x20f)][_0x129a02(0x235)],_0x221fd0['serverldap'][_0x129a02(0x238)],_0x4150f1=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x3c97d4=_0x129a02;if(_0x4150f1)return _0xcda37c['unbind'](),_0xcda37c[_0x3c97d4(0x233)](),_0x111bde[_0x3c97d4(0x206)]({'errors':[{'location':_0x3c97d4(0x1fc),'msg':_0x3c97d4(0x21c),'param':'servers'}]});else{var _0x14ddaa={'filter':_0x3c97d4(0x215)+_0x194281[_0x3c97d4(0x229)][_0x3c97d4(0x1d6)],'scope':_0x3c97d4(0x203)};yield _0xcda37c[_0x3c97d4(0x20d)](_0x221fd0[_0x3c97d4(0x20f)][_0x3c97d4(0x202)],_0x14ddaa,function(_0x36c8ac,_0x183a13){const _0x32a013=_0x3c97d4;if(_0x36c8ac)return _0xcda37c['unbind'](),_0xcda37c[_0x32a013(0x233)](),_0x111bde[_0x32a013(0x206)]({'errors':[{'location':_0x32a013(0x1fc),'msg':_0x32a013(0x1ff),'param':'servers'}]});else _0x183a13['on'](_0x32a013(0x1dc),function(_0x16b66e){const _0xd63271=_0x32a013;return _0xcda37c[_0xd63271(0x20b)](),_0xcda37c[_0xd63271(0x233)](),_0x111bde[_0xd63271(0x206)](_0x16b66e[_0xd63271(0x1fa)]);}),_0x183a13['on'](_0x32a013(0x1db),function(_0x5ec29a){const _0x4ed55f=_0x32a013;return _0xcda37c[_0x4ed55f(0x20b)](),_0xcda37c[_0x4ed55f(0x233)](),_0x111bde[_0x4ed55f(0x206)]({'errors':[{'location':'search\x20source','msg':'Lo\x20sentimos\x20no\x20se\x20pudo\x20encontrar\x20la\x20entidad\x20especificada','param':_0x4ed55f(0x20e)}]});});});}}));}else return _0x111bde[_0x129a02(0x206)]({'errors':[{'location':_0x129a02(0x1f1),'msg':_0x129a02(0x228),'param':_0x129a02(0x20e)}]});}else return _0x111bde[_0x129a02(0x206)]({'errors':[{'location':_0x129a02(0x216),'msg':'Lo\x20sentimos\x20este\x20servidor\x20proxy\x20no\x20se\x20encuentra\x20registrado','param':_0x129a02(0x20e)}]});}))[_0x553480(0x22e)](_0x283471=>{const _0x213aa5=_0x553480;return _0x111bde[_0x213aa5(0x206)]({'errors':[{'location':_0x213aa5(0x216),'msg':'Lo\x20sentimos\x20no\x20se\x20pudieron\x20obtener\x20los\x20datos\x20del\x20servidor\x20proxy','param':'servers'}]});});});exports[a83_0x2e85fd(0x224)]=getSourceInfo;const deleteServer=(_0x43c1e0,_0x4f95b8)=>{const _0x390e85=a83_0x2e85fd;ServerLdap_1[_0x390e85(0x217)][_0x390e85(0x1f3)](_0x43c1e0[_0x390e85(0x201)]['id'])[_0x390e85(0x210)](_0x390e85(0x200))[_0x390e85(0x1e5)](_0x54a8ea=>{const _0x604c31=_0x390e85;if(_0x54a8ea)_0x54a8ea[_0x604c31(0x200)]!==undefined&&_0x54a8ea[_0x604c31(0x200)]['length']>0x0&&_0x54a8ea[_0x604c31(0x200)][_0x604c31(0x1e0)]((_0x48002f,_0x59d660)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x204d45=_0x604c31;yield Server_1['Server']['collection'][_0x204d45(0x236)]({'_id':_0x48002f[_0x204d45(0x214)]},{'$unset':{'serverldap':0x1}});})),ServerLdap_1[_0x604c31(0x217)][_0x604c31(0x239)](_0x43c1e0[_0x604c31(0x201)]['id'])[_0x604c31(0x1e5)](()=>{const _0x588f92=_0x604c31;return _0x4f95b8[_0x588f92(0x206)](_0x54a8ea);})['catch'](_0x4db849=>{const _0x4be0fa=_0x604c31;return _0x4f95b8['json']({'errors':[{'location':_0x4be0fa(0x1f9),'msg':_0x4be0fa(0x1e7),'param':'connection'}]});});else return _0x4f95b8['json']({'errors':[{'location':_0x604c31(0x1e6),'msg':_0x604c31(0x21a),'param':_0x604c31(0x20a)}]});})['catch'](_0x5265f5=>{const _0x25eeab=_0x390e85;return _0x4f95b8[_0x25eeab(0x206)]({'errors':[{'location':_0x25eeab(0x1e6),'msg':'Lo\x20sentimos\x20no\x20se\x20pudieron\x20obtener\x20los\x20datos\x20del\x20servidor\x20LDAP','param':'findserver'}]});});};function a83_0xaae6(_0x2f12ed,_0x2287bf){const _0x5b5983=a83_0x5b59();return a83_0xaae6=function(_0xaae65,_0x1032dc){_0xaae65=_0xaae65-0x1d6;let _0x32780d=_0x5b5983[_0xaae65];return _0x32780d;},a83_0xaae6(_0x2f12ed,_0x2287bf);}exports[a83_0x2e85fd(0x225)]=deleteServer;