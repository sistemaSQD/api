'use strict';const a10_0x520b7b=a10_0x55a1;(function(_0x588ed,_0x1433cc){const _0x3b3e19=a10_0x55a1,_0xd68f0a=_0x588ed();while(!![]){try{const _0x228788=parseInt(_0x3b3e19(0x98))/0x1+-parseInt(_0x3b3e19(0xbd))/0x2+-parseInt(_0x3b3e19(0x9b))/0x3+-parseInt(_0x3b3e19(0xce))/0x4+parseInt(_0x3b3e19(0x6c))/0x5*(parseInt(_0x3b3e19(0x89))/0x6)+parseInt(_0x3b3e19(0xc0))/0x7*(parseInt(_0x3b3e19(0xa9))/0x8)+-parseInt(_0x3b3e19(0xa6))/0x9;if(_0x228788===_0x1433cc)break;else _0xd68f0a['push'](_0xd68f0a['shift']());}catch(_0x1eab09){_0xd68f0a['push'](_0xd68f0a['shift']());}}}(a10_0x17e4,0xe2d2c));var __awaiter=this&&this[a10_0x520b7b(0xac)]||function(_0x5b7b44,_0xbd2388,_0x15d1eb,_0x3aff4c){function _0x390391(_0x435e8a){return _0x435e8a instanceof _0x15d1eb?_0x435e8a:new _0x15d1eb(function(_0x16a860){_0x16a860(_0x435e8a);});}return new(_0x15d1eb||(_0x15d1eb=Promise))(function(_0x48538c,_0x57d563){const _0x2cb928=a10_0x55a1;function _0x5e2316(_0x443129){const _0x5ec3b8=a10_0x55a1;try{_0x1f0555(_0x3aff4c[_0x5ec3b8(0xc9)](_0x443129));}catch(_0x182d5e){_0x57d563(_0x182d5e);}}function _0x1641ee(_0x47ae04){const _0x40c9ef=a10_0x55a1;try{_0x1f0555(_0x3aff4c[_0x40c9ef(0xab)](_0x47ae04));}catch(_0xb18e1a){_0x57d563(_0xb18e1a);}}function _0x1f0555(_0xdae1bf){const _0x1b34d8=a10_0x55a1;_0xdae1bf[_0x1b34d8(0xc1)]?_0x48538c(_0xdae1bf[_0x1b34d8(0xbb)]):_0x390391(_0xdae1bf[_0x1b34d8(0xbb)])[_0x1b34d8(0xb2)](_0x5e2316,_0x1641ee);}_0x1f0555((_0x3aff4c=_0x3aff4c[_0x2cb928(0x76)](_0x5b7b44,_0xbd2388||[]))[_0x2cb928(0xc9)]());});};Object[a10_0x520b7b(0x9d)](exports,a10_0x520b7b(0x78),{'value':!![]}),exports[a10_0x520b7b(0x88)]=exports['getSourceInfo']=exports['linkProxyServer']=exports[a10_0x520b7b(0x9a)]=exports['getLdapServers']=void 0x0;const express_validator_1=require(a10_0x520b7b(0x95)),ServerLdap_1=require('../models/ServerLdap'),Server_1=require(a10_0x520b7b(0xca)),ldap=require(a10_0x520b7b(0xa0)),getLdapServers=(_0x6f0c3,_0x18461a)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x1b2ad2=a10_0x520b7b;let _0x1cb336=yield ServerLdap_1[_0x1b2ad2(0x79)][_0x1b2ad2(0xb9)]()['then'](_0x4625ac=>{return _0x4625ac;})[_0x1b2ad2(0x83)](_0x5ea07e=>{const _0x3d277d=_0x1b2ad2;return{'errors':[{'location':_0x3d277d(0x86),'msg':'Lo\x20sentimos\x20no\x20se\x20pudieron\x20obtener\x20los\x20datos\x20de\x20los\x20servidores\x20LDAP','param':_0x3d277d(0x93)}]};});return _0x18461a[_0x1b2ad2(0xad)](_0x1cb336);});exports[a10_0x520b7b(0x86)]=getLdapServers;const register=(_0x54366d,_0x403cfe)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x15bc54=a10_0x520b7b;yield express_validator_1[_0x15bc54(0x7e)](_0x15bc54(0x9e))[_0x15bc54(0xaf)]()[_0x15bc54(0xb1)]('host_empty')[_0x15bc54(0x82)](_0x54366d);const _0x2d892f=_0x374190=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x57feee=_0x15bc54;if(!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x57feee(0x96)](_0x54366d['body'][_0x57feee(0x9e)]))return Promise[_0x57feee(0x91)](_0x57feee(0x94));}),_0x15782d=_0x5bfe37=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x56d947=_0x15bc54;return yield ServerLdap_1[_0x56d947(0x79)][_0x56d947(0x85)]({'host':_0x54366d[_0x56d947(0x9f)]['host']})[_0x56d947(0xb2)](_0x56535c=>{const _0x38622d=_0x56d947;if(_0x56535c)return Promise['reject'](_0x38622d(0x7c));});});yield express_validator_1[_0x15bc54(0x7e)](_0x15bc54(0x9e))[_0x15bc54(0x6e)](_0x2d892f)[_0x15bc54(0x82)](_0x54366d),yield express_validator_1[_0x15bc54(0x7e)]('host')[_0x15bc54(0x6e)](_0x15782d)[_0x15bc54(0x82)](_0x54366d);const _0x280418=express_validator_1['validationResult'](_0x54366d);if(!_0x280418['isEmpty']())return _0x403cfe[_0x15bc54(0xb8)](0x190)[_0x15bc54(0xad)]({'errors':_0x280418[_0x15bc54(0x74)]()});const _0x176c76=ldap[_0x15bc54(0xcf)]({'url':[_0x15bc54(0xa2)+_0x54366d[_0x15bc54(0x9f)][_0x15bc54(0x9e)]+':'+_0x54366d[_0x15bc54(0x9f)]['port']],'reconnect':!![]});yield _0x176c76[_0x15bc54(0x6b)](_0x54366d[_0x15bc54(0x9f)][_0x15bc54(0xa1)],_0x54366d[_0x15bc54(0x9f)][_0x15bc54(0xb6)],_0x1687cb=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x3e5a22=_0x15bc54;if(_0x1687cb)return _0x403cfe[_0x3e5a22(0xad)]({'errors':[{'location':_0x3e5a22(0x9a),'msg':_0x3e5a22(0xb0),'param':_0x3e5a22(0x81)}]});else yield _0x176c76[_0x3e5a22(0x7d)](_0x54366d[_0x3e5a22(0x9f)][_0x3e5a22(0xbf)],{},function(_0xbad72e,_0xe8ab6f){const _0x41e987=_0x3e5a22;if(_0xbad72e)return _0x403cfe['json']({'errors':[{'location':_0x41e987(0x9a),'msg':_0x41e987(0x70),'param':'savedserver'}]});else _0xe8ab6f['on'](_0x41e987(0x73),function(_0x5e0d88){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x100fdb=a10_0x55a1;let _0x2f2d70=new ServerLdap_1[(_0x100fdb(0x72))]({'host':_0x54366d['body']['host'],'port':_0x54366d[_0x100fdb(0x9f)][_0x100fdb(0xb4)],'dnbase':_0x54366d[_0x100fdb(0x9f)][_0x100fdb(0xbf)],'dnuser':_0x54366d[_0x100fdb(0x9f)][_0x100fdb(0xa1)],'encryption':_0x54366d['body'][_0x100fdb(0xa7)],'password':_0x54366d[_0x100fdb(0x9f)][_0x100fdb(0xb6)]});return yield ServerLdap_1[_0x100fdb(0x79)][_0x100fdb(0x84)](_0x2f2d70,(_0x4718a3,_0x4188b9)=>{const _0x94a50a=_0x100fdb;if(_0x4718a3)return _0x403cfe[_0x94a50a(0xad)]({'errors':[{'location':'register','msg':'Lo\x20sentimos\x20no\x20se\x20pudo\x20registrar\x20el\x20servidor\x20LDAP','param':'savedserver'}]});else return _0x403cfe[_0x94a50a(0xad)](_0x4188b9);});});}),_0xe8ab6f['on'](_0x41e987(0xcc),function(_0x2019fe){const _0x399ed8=_0x41e987;return console[_0x399ed8(0xcc)](_0x399ed8(0xa8)+_0x2019fe[_0x399ed8(0xb7)]),_0x403cfe['json']({'errors':[{'location':_0x399ed8(0x9a),'msg':_0x399ed8(0xcb),'param':_0x399ed8(0x81)}]});});});}));});exports[a10_0x520b7b(0x9a)]=register;const linkProxyServer=(_0x267dd9,_0x5974)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x2c503b=a10_0x520b7b;yield ServerLdap_1['ServerLdap'][_0x2c503b(0x69)](_0x267dd9[_0x2c503b(0x9f)][_0x2c503b(0x9c)])['populate']('proxyservers')[_0x2c503b(0xb2)](_0x235f95=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x14d0cd=_0x2c503b;yield Server_1['Server'][_0x14d0cd(0x69)](_0x267dd9[_0x14d0cd(0x9f)][_0x14d0cd(0x71)])['populate'](_0x14d0cd(0xc7))['then'](_0x2987e1=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x228ae3=_0x14d0cd;if(_0x267dd9[_0x228ae3(0x9f)][_0x228ae3(0x9c)]==_0x228ae3(0x90)){if(_0x2987e1[_0x228ae3(0xc7)]!==undefined){let _0x4cbb28=yield _0x2987e1[_0x228ae3(0xc7)][_0x228ae3(0xc8)]('proxyservers')['execPopulate'](),_0x24d89d=_0x4cbb28[_0x228ae3(0x97)][_0x228ae3(0xc5)](function(_0x505640){const _0x1a96e8=_0x228ae3;return _0x505640[_0x1a96e8(0x9e)]!=_0x2987e1[_0x1a96e8(0x9e)];});return _0x4cbb28[_0x228ae3(0x97)]=_0x24d89d,_0x4cbb28[_0x228ae3(0x8f)](),yield Server_1['Server'][_0x228ae3(0x7a)][_0x228ae3(0x7f)]({'_id':_0x2987e1['_id']},{'$unset':{'serverldap':0x1}}),_0x5974[_0x228ae3(0xad)]({'status':_0x228ae3(0x92),'msg':_0x228ae3(0x8d)});}else return _0x5974[_0x228ae3(0xad)]({'status':'nothingtodo','msg':_0x228ae3(0x99)});}else{let _0x1b19da=_0x235f95[_0x228ae3(0x97)]['filter'](function(_0x30d9c3){const _0x508da3=_0x228ae3;return _0x30d9c3[_0x508da3(0x9e)]==_0x2987e1[_0x508da3(0x9e)];});if(_0x1b19da[_0x228ae3(0xcd)]>0x0)return _0x5974[_0x228ae3(0xad)]({'errors':[{'location':_0x228ae3(0x6a),'msg':_0x228ae3(0xc4)}]});else{if(_0x2987e1['serverldap']){let _0x4be4fa=yield _0x2987e1[_0x228ae3(0xc7)]['populate'](_0x228ae3(0x97))[_0x228ae3(0xb3)](),_0x586a3d=_0x4be4fa[_0x228ae3(0x97)]['filter'](function(_0x3fe63f){const _0x4b8511=_0x228ae3;return _0x3fe63f[_0x4b8511(0x9e)]!=_0x2987e1[_0x4b8511(0x9e)];});_0x4be4fa['proxyservers']=_0x586a3d,_0x4be4fa[_0x228ae3(0x8f)]();}return _0x2987e1[_0x228ae3(0xc7)]=_0x235f95[_0x228ae3(0x8a)],_0x2987e1[_0x228ae3(0x8f)](),_0x235f95[_0x228ae3(0x97)][_0x228ae3(0xc2)](_0x2987e1),_0x235f95[_0x228ae3(0x8f)](),_0x5974['json']({'status':'ok','msg':_0x228ae3(0x8c)});}}}))['catch'](_0xaae29d=>{const _0x5450f6=_0x14d0cd;return _0x5974[_0x5450f6(0xad)]({'errors':[{'location':'find\x20proxy\x20server','msg':'Lo\x20sentimos\x20no\x20se\x20pudieron\x20obtener\x20los\x20datos\x20del\x20servidor\x20proxy','param':_0x5450f6(0x93)}]});});}))['catch'](_0x1f1996=>{const _0x4e230d=_0x2c503b;return _0x5974[_0x4e230d(0xad)]({'errors':[{'location':_0x4e230d(0x87),'msg':'Lo\x20sentimos\x20no\x20se\x20pudieron\x20obtener\x20los\x20datos\x20del\x20servidor\x20LDAP','param':'servers'}]});});});exports['linkProxyServer']=linkProxyServer;function a10_0x55a1(_0xb2641d,_0x237471){const _0x17e40b=a10_0x17e4();return a10_0x55a1=function(_0x55a103,_0xa85299){_0x55a103=_0x55a103-0x69;let _0x2508f7=_0x17e40b[_0x55a103];return _0x2508f7;},a10_0x55a1(_0xb2641d,_0x237471);}const getSourceInfo=(_0x5d7bc9,_0x43330b)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x570586=a10_0x520b7b;yield Server_1[_0x570586(0x6f)][_0x570586(0x85)]({'host':_0x5d7bc9[_0x570586(0x9f)][_0x570586(0x9e)]})[_0x570586(0xc8)](_0x570586(0xc7))[_0x570586(0xb2)](_0x272e9a=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x1e5cf0=_0x570586;if(_0x272e9a){if(_0x272e9a[_0x1e5cf0(0xc7)]){const _0x277afe=ldap[_0x1e5cf0(0xcf)]({'url':[_0x1e5cf0(0xa2)+_0x272e9a[_0x1e5cf0(0xc7)][_0x1e5cf0(0x9e)]+':'+_0x272e9a[_0x1e5cf0(0xc7)][_0x1e5cf0(0xb4)]]});yield _0x277afe[_0x1e5cf0(0x6b)](_0x272e9a[_0x1e5cf0(0xc7)]['dnuser'],_0x272e9a['serverldap']['password'],_0x15edb2=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x2e195e=_0x1e5cf0;if(_0x15edb2)return _0x277afe[_0x2e195e(0xb5)](),_0x277afe[_0x2e195e(0xba)](),_0x43330b['json']({'errors':[{'location':_0x2e195e(0xaa),'msg':_0x2e195e(0xb0),'param':_0x2e195e(0x93)}]});else{var _0x146ed0={'filter':_0x2e195e(0x8b)+_0x5d7bc9[_0x2e195e(0x9f)][_0x2e195e(0x7b)],'scope':_0x2e195e(0xc6)};yield _0x277afe[_0x2e195e(0x7d)](_0x272e9a['serverldap'][_0x2e195e(0xbf)],_0x146ed0,function(_0x309a79,_0x10ac2d){const _0x5569d9=_0x2e195e;if(_0x309a79)return _0x277afe['unbind'](),_0x277afe[_0x5569d9(0xba)](),_0x43330b[_0x5569d9(0xad)]({'errors':[{'location':_0x5569d9(0xaa),'msg':'Lo\x20sentimos\x20el\x20Dn\x20Base\x20es\x20incorrecto','param':'servers'}]});else _0x10ac2d['on'](_0x5569d9(0x73),function(_0x189255){const _0x56d4a9=_0x5569d9;return _0x277afe[_0x56d4a9(0xb5)](),_0x277afe[_0x56d4a9(0xba)](),_0x43330b[_0x56d4a9(0xad)](_0x189255['object']);}),_0x10ac2d['on']('error',function(_0x5aecde){const _0x57ee9a=_0x5569d9;return _0x277afe[_0x57ee9a(0xb5)](),_0x277afe[_0x57ee9a(0xba)](),_0x43330b[_0x57ee9a(0xad)]({'errors':[{'location':'search\x20source','msg':_0x57ee9a(0xa5),'param':'servers'}]});});});}}));}else return _0x43330b[_0x1e5cf0(0xad)]({'errors':[{'location':_0x1e5cf0(0x87),'msg':_0x1e5cf0(0xae),'param':_0x1e5cf0(0x93)}]});}else return _0x43330b['json']({'errors':[{'location':_0x1e5cf0(0x77),'msg':_0x1e5cf0(0x8e),'param':_0x1e5cf0(0x93)}]});}))[_0x570586(0x83)](_0x4c8449=>{const _0x155944=_0x570586;return _0x43330b[_0x155944(0xad)]({'errors':[{'location':_0x155944(0x77),'msg':_0x155944(0xa4),'param':_0x155944(0x93)}]});});});exports['getSourceInfo']=getSourceInfo;const deleteServer=(_0x2abfac,_0x43d0f5)=>{const _0x1b9efc=a10_0x520b7b;ServerLdap_1[_0x1b9efc(0x79)][_0x1b9efc(0x69)](_0x2abfac[_0x1b9efc(0xc3)]['id'])['populate']('proxyservers')[_0x1b9efc(0xb2)](_0x5b5fd7=>{const _0x28ee7d=_0x1b9efc;if(_0x5b5fd7)_0x5b5fd7[_0x28ee7d(0x97)]!==undefined&&_0x5b5fd7[_0x28ee7d(0x97)][_0x28ee7d(0xcd)]>0x0&&_0x5b5fd7[_0x28ee7d(0x97)]['map']((_0x31720e,_0x225dae)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x384f7f=_0x28ee7d;yield Server_1['Server'][_0x384f7f(0x7a)]['updateOne']({'_id':_0x31720e[_0x384f7f(0x8a)]},{'$unset':{'serverldap':0x1}});})),ServerLdap_1[_0x28ee7d(0x79)]['findByIdAndDelete'](_0x2abfac[_0x28ee7d(0xc3)]['id'])[_0x28ee7d(0xb2)](()=>{const _0x435f8c=_0x28ee7d;return _0x43d0f5[_0x435f8c(0xad)](_0x5b5fd7);})[_0x28ee7d(0x83)](_0x41fe0b=>{const _0x234ba0=_0x28ee7d;return _0x43d0f5['json']({'errors':[{'location':_0x234ba0(0x6a),'msg':_0x234ba0(0xbe),'param':_0x234ba0(0xa3)}]});});else return _0x43d0f5[_0x28ee7d(0xad)]({'errors':[{'location':_0x28ee7d(0x75),'msg':_0x28ee7d(0x80),'param':_0x28ee7d(0x9e)}]});})[_0x1b9efc(0x83)](_0x4e8505=>{const _0x3c3edf=_0x1b9efc;return _0x43d0f5['json']({'errors':[{'location':_0x3c3edf(0x75),'msg':_0x3c3edf(0xbc),'param':_0x3c3edf(0x6d)}]});});};function a10_0x17e4(){const _0x230c2d=['json','Lo\x20sentimos\x20el\x20servidor\x20proxy\x20no\x20tiene\x20ningún\x20servidor\x20LDAP\x20asociado','notEmpty','Lo\x20sentimos\x20los\x20datos\x20de\x20autenticación\x20son\x20incorrectos','withMessage','then','execPopulate','port','unbind','password','message','status','find','destroy','value','Lo\x20sentimos\x20no\x20se\x20pudieron\x20obtener\x20los\x20datos\x20del\x20servidor\x20LDAP','181752ZndYnV','Lo\x20sentimos\x20no\x20se\x20pudo\x20eliminar\x20el\x20servidor\x20LDAP','dnbase','442309TfSLEA','done','push','params','Lo\x20sentimos\x20el\x20servidor\x20proxy\x20ya\x20está\x20vinculado\x20a\x20este\x20servidor\x20LDAP','filter','sub','serverldap','populate','next','../models/Server','Lo\x20sentimos\x20no\x20se\x20pudo\x20encontrar\x20ninguna\x20entidad\x20en\x20el\x20servidor\x20LDAP','error','length','2313748STzOMf','createClient','findById','update','bind','342610GPTGAl','findserver','custom','Server','Lo\x20sentimos\x20el\x20Dn\x20Base\x20es\x20incorrecto','proxyid','ServerLdapInterface','searchEntry','array','delete','apply','find\x20proxy\x20server','__esModule','ServerLdap','collection','source','host_found','search','check','updateOne','Lo\x20sentimos\x20este\x20servidor\x20LDAP\x20no\x20se\x20encuentra\x20registrado','savedserver','run','catch','create','findOne','getLdapServers','find\x20ldap\x20server','deleteServer','156kPiZuI','_id','samaccountname=','El\x20vinculo\x20ha\x20sido\x20realizado\x20correctamente','Servidor\x20LDAP\x20eliminado\x20correctamente','Lo\x20sentimos\x20este\x20servidor\x20proxy\x20no\x20se\x20encuentra\x20registrado','save','noldapserver','reject','serverldapdeleted','servers','host_not_is_ip','express-validator','test','proxyservers','505560LANWEx','Nada\x20que\x20hacer\x20con\x20el\x20servidor\x20ldap','register','1823391glQPpn','ldapid','defineProperty','host','body','ldapjs','dnuser','ldap://','connection','Lo\x20sentimos\x20no\x20se\x20pudieron\x20obtener\x20los\x20datos\x20del\x20servidor\x20proxy','Lo\x20sentimos\x20no\x20se\x20pudo\x20encontrar\x20la\x20entidad\x20especificada','15514344IRWObu','encryption','error:\x20','208qaDtBO','auth\x20ldap\x20server','throw','__awaiter'];a10_0x17e4=function(){return _0x230c2d;};return a10_0x17e4();}exports[a10_0x520b7b(0x88)]=deleteServer;