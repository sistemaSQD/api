'use strict';const a10_0x17b607=a10_0x239c;(function(_0x4b372f,_0x1dbb32){const _0x4e38da=a10_0x239c,_0x196857=_0x4b372f();while(!![]){try{const _0x5d4afd=-parseInt(_0x4e38da(0x233))/0x1+parseInt(_0x4e38da(0x237))/0x2+parseInt(_0x4e38da(0x239))/0x3+parseInt(_0x4e38da(0x23b))/0x4*(-parseInt(_0x4e38da(0x214))/0x5)+-parseInt(_0x4e38da(0x202))/0x6*(parseInt(_0x4e38da(0x22b))/0x7)+-parseInt(_0x4e38da(0x1fd))/0x8*(parseInt(_0x4e38da(0x234))/0x9)+parseInt(_0x4e38da(0x20c))/0xa;if(_0x5d4afd===_0x1dbb32)break;else _0x196857['push'](_0x196857['shift']());}catch(_0x49d125){_0x196857['push'](_0x196857['shift']());}}}(a10_0x33f2,0x7ad0a));var __awaiter=this&&this['__awaiter']||function(_0x147caf,_0x492fbf,_0x528d5c,_0xd7d3ec){function _0x198e77(_0x5a2d0e){return _0x5a2d0e instanceof _0x528d5c?_0x5a2d0e:new _0x528d5c(function(_0xa2d070){_0xa2d070(_0x5a2d0e);});}return new(_0x528d5c||(_0x528d5c=Promise))(function(_0x52b53e,_0x427e8e){const _0x2d00cc=a10_0x239c;function _0x28622c(_0x26c216){const _0x13ef80=a10_0x239c;try{_0xf39f51(_0xd7d3ec[_0x13ef80(0x211)](_0x26c216));}catch(_0x40b335){_0x427e8e(_0x40b335);}}function _0x19f11d(_0x50332f){try{_0xf39f51(_0xd7d3ec['throw'](_0x50332f));}catch(_0x1b14f4){_0x427e8e(_0x1b14f4);}}function _0xf39f51(_0xaa8213){const _0x28ffbe=a10_0x239c;_0xaa8213[_0x28ffbe(0x232)]?_0x52b53e(_0xaa8213['value']):_0x198e77(_0xaa8213[_0x28ffbe(0x245)])['then'](_0x28622c,_0x19f11d);}_0xf39f51((_0xd7d3ec=_0xd7d3ec['apply'](_0x147caf,_0x492fbf||[]))[_0x2d00cc(0x211)]());});};function a10_0x239c(_0x37e3dc,_0xd3d81b){const _0x33f26c=a10_0x33f2();return a10_0x239c=function(_0x239c3b,_0x188ca2){_0x239c3b=_0x239c3b-0x1ed;let _0x554de3=_0x33f26c[_0x239c3b];return _0x554de3;},a10_0x239c(_0x37e3dc,_0xd3d81b);}Object[a10_0x17b607(0x225)](exports,a10_0x17b607(0x23e),{'value':!![]}),exports[a10_0x17b607(0x200)]=exports[a10_0x17b607(0x235)]=exports[a10_0x17b607(0x244)]=exports[a10_0x17b607(0x219)]=exports[a10_0x17b607(0x204)]=void 0x0;const express_validator_1=require(a10_0x17b607(0x1f0)),ServerLdap_1=require('../models/ServerLdap'),Server_1=require(a10_0x17b607(0x206)),ldap=require(a10_0x17b607(0x1f9)),getLdapServers=(_0x151d33,_0x25a924)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x23372c=a10_0x17b607;let _0x39e652=yield ServerLdap_1['ServerLdap'][_0x23372c(0x205)]()[_0x23372c(0x21d)](_0x4d85d2=>{return _0x4d85d2;})[_0x23372c(0x1fc)](_0x4ba72f=>{const _0x19ce18=_0x23372c;return{'errors':[{'location':_0x19ce18(0x204),'msg':_0x19ce18(0x22d),'param':_0x19ce18(0x23a)}]};});return _0x25a924[_0x23372c(0x22e)](_0x39e652);});exports[a10_0x17b607(0x204)]=getLdapServers;const register=(_0x41adcf,_0x2f27c1)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x2f821c=a10_0x17b607;yield express_validator_1['check'](_0x2f821c(0x21b))[_0x2f821c(0x230)]()[_0x2f821c(0x23c)]('host_empty')[_0x2f821c(0x207)](_0x41adcf);const _0x909ba0=_0x10d844=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x3d3e01=_0x2f821c;if(!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x3d3e01(0x241)](_0x41adcf[_0x3d3e01(0x22c)][_0x3d3e01(0x21b)]))return Promise[_0x3d3e01(0x215)](_0x3d3e01(0x249));}),_0x30607a=_0x31f92c=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x27e491=_0x2f821c;return yield ServerLdap_1['ServerLdap'][_0x27e491(0x226)]({'host':_0x41adcf[_0x27e491(0x22c)][_0x27e491(0x21b)]})[_0x27e491(0x21d)](_0x26933f=>{const _0x45d55e=_0x27e491;if(_0x26933f)return Promise[_0x45d55e(0x215)](_0x45d55e(0x1f6));});});yield express_validator_1['check'](_0x2f821c(0x21b))['custom'](_0x909ba0)[_0x2f821c(0x207)](_0x41adcf),yield express_validator_1[_0x2f821c(0x20a)](_0x2f821c(0x21b))[_0x2f821c(0x246)](_0x30607a)[_0x2f821c(0x207)](_0x41adcf);const _0x1a6991=express_validator_1[_0x2f821c(0x213)](_0x41adcf);if(!_0x1a6991[_0x2f821c(0x228)]())return _0x2f27c1[_0x2f821c(0x23f)](0x190)[_0x2f821c(0x22e)]({'errors':_0x1a6991[_0x2f821c(0x216)]()});const _0x8ba065=ldap[_0x2f821c(0x1ee)]({'url':[_0x2f821c(0x242)+_0x41adcf[_0x2f821c(0x22c)]['host']+':'+_0x41adcf[_0x2f821c(0x22c)]['port']],'reconnect':!![]});yield _0x8ba065[_0x2f821c(0x20f)](_0x41adcf[_0x2f821c(0x22c)][_0x2f821c(0x218)],_0x41adcf[_0x2f821c(0x22c)]['password'],_0x518f57=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x457366=_0x2f821c;if(_0x518f57)return _0x2f27c1[_0x457366(0x22e)]({'errors':[{'location':_0x457366(0x219),'msg':_0x457366(0x1fe),'param':_0x457366(0x220)}]});else yield _0x8ba065['search'](_0x41adcf[_0x457366(0x22c)][_0x457366(0x21f)],{},function(_0x20c99f,_0x5b16f3){const _0x5f1f2f=_0x457366;if(_0x20c99f)return _0x2f27c1[_0x5f1f2f(0x22e)]({'errors':[{'location':_0x5f1f2f(0x219),'msg':_0x5f1f2f(0x24b),'param':'savedserver'}]});else _0x5b16f3['on']('searchEntry',function(_0x2ac1b2){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x569cd2=a10_0x239c;let _0x443efe=new ServerLdap_1[(_0x569cd2(0x1fa))]({'host':_0x41adcf[_0x569cd2(0x22c)][_0x569cd2(0x21b)],'port':_0x41adcf[_0x569cd2(0x22c)][_0x569cd2(0x201)],'dnbase':_0x41adcf[_0x569cd2(0x22c)]['dnbase'],'dnuser':_0x41adcf[_0x569cd2(0x22c)][_0x569cd2(0x218)],'encryption':_0x41adcf['body'][_0x569cd2(0x21a)],'password':_0x41adcf[_0x569cd2(0x22c)][_0x569cd2(0x243)]});return yield ServerLdap_1[_0x569cd2(0x236)][_0x569cd2(0x24a)](_0x443efe,(_0x4b9c61,_0x124538)=>{const _0x4ce502=_0x569cd2;if(_0x4b9c61)return _0x2f27c1[_0x4ce502(0x22e)]({'errors':[{'location':'register','msg':'Lo\x20sentimos\x20no\x20se\x20pudo\x20registrar\x20el\x20servidor\x20LDAP','param':_0x4ce502(0x220)}]});else return _0x2f27c1[_0x4ce502(0x22e)](_0x124538);});});}),_0x5b16f3['on'](_0x5f1f2f(0x1f5),function(_0x2aad3b){const _0x3995f4=_0x5f1f2f;return console['error'](_0x3995f4(0x210)+_0x2aad3b[_0x3995f4(0x203)]),_0x2f27c1[_0x3995f4(0x22e)]({'errors':[{'location':_0x3995f4(0x219),'msg':'Lo\x20sentimos\x20no\x20se\x20pudo\x20encontrar\x20ninguna\x20entidad\x20en\x20el\x20servidor\x20LDAP','param':'savedserver'}]});});});}));});exports[a10_0x17b607(0x219)]=register;function a10_0x33f2(){const _0x9af2ce=['params','serverldap','defineProperty','findOne','ldapid','isEmpty','map','findById','1375101Mckdzp','body','Lo\x20sentimos\x20no\x20se\x20pudieron\x20obtener\x20los\x20datos\x20de\x20los\x20servidores\x20LDAP','json','noldapserver','notEmpty','destroy','done','576479wEcwmB','9090wPVObW','getSourceInfo','ServerLdap','506796tnRUwC','unbind','528498xpPPKF','servers','193636QWSjlz','withMessage','source','__esModule','status','Servidor\x20LDAP\x20eliminado\x20correctamente','test','ldap://','password','linkProxyServer','value','custom','length','proxyid','host_not_is_ip','create','Lo\x20sentimos\x20el\x20Dn\x20Base\x20es\x20incorrecto','proxyservers','_id','serverldapdeleted','createClient','filter','express-validator','searchEntry','find\x20ldap\x20server','Server','save','error','host_found','Nada\x20que\x20hacer\x20con\x20el\x20servidor\x20ldap','findByIdAndDelete','ldapjs','ServerLdapInterface','Lo\x20sentimos\x20no\x20se\x20pudieron\x20obtener\x20los\x20datos\x20del\x20servidor\x20LDAP','catch','1096QEMbsV','Lo\x20sentimos\x20los\x20datos\x20de\x20autenticación\x20son\x20incorrectos','auth\x20ldap\x20server','deleteServer','port','6RpkHTJ','message','getLdapServers','find','../models/Server','run','update','collection','check','push','15172770dOTdtg','execPopulate','Lo\x20sentimos\x20no\x20se\x20pudo\x20encontrar\x20la\x20entidad\x20especificada','bind','error:\x20','next','updateOne','validationResult','55BdsHms','reject','array','El\x20vinculo\x20ha\x20sido\x20realizado\x20correctamente','dnuser','register','encryption','host','find\x20proxy\x20server','then','sub','dnbase','savedserver','populate','object'];a10_0x33f2=function(){return _0x9af2ce;};return a10_0x33f2();}const linkProxyServer=(_0x46bcc4,_0x348e56)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x4f16c1=a10_0x17b607;yield ServerLdap_1[_0x4f16c1(0x236)][_0x4f16c1(0x22a)](_0x46bcc4[_0x4f16c1(0x22c)][_0x4f16c1(0x227)])[_0x4f16c1(0x221)](_0x4f16c1(0x24c))[_0x4f16c1(0x21d)](_0x18e44a=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x178251=_0x4f16c1;yield Server_1['Server'][_0x178251(0x22a)](_0x46bcc4['body'][_0x178251(0x248)])[_0x178251(0x221)](_0x178251(0x224))[_0x178251(0x21d)](_0x4fe86f=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x3e6af6=_0x178251;if(_0x46bcc4['body']['ldapid']==_0x3e6af6(0x22f)){if(_0x4fe86f['serverldap']!==undefined){let _0x543d37=yield _0x4fe86f[_0x3e6af6(0x224)][_0x3e6af6(0x221)](_0x3e6af6(0x24c))[_0x3e6af6(0x20d)](),_0x4de5a1=_0x543d37[_0x3e6af6(0x24c)][_0x3e6af6(0x1ef)](function(_0x9c0bb1){const _0x5462c6=_0x3e6af6;return _0x9c0bb1[_0x5462c6(0x21b)]!=_0x4fe86f['host'];});return _0x543d37[_0x3e6af6(0x24c)]=_0x4de5a1,_0x543d37[_0x3e6af6(0x1f4)](),yield Server_1[_0x3e6af6(0x1f3)][_0x3e6af6(0x209)][_0x3e6af6(0x212)]({'_id':_0x4fe86f['_id']},{'$unset':{'serverldap':0x1}}),_0x348e56[_0x3e6af6(0x22e)]({'status':_0x3e6af6(0x1ed),'msg':_0x3e6af6(0x240)});}else return _0x348e56[_0x3e6af6(0x22e)]({'status':'nothingtodo','msg':_0x3e6af6(0x1f7)});}else{let _0x5e14bb=_0x18e44a[_0x3e6af6(0x24c)][_0x3e6af6(0x1ef)](function(_0x5b825d){const _0x4caab4=_0x3e6af6;return _0x5b825d[_0x4caab4(0x21b)]==_0x4fe86f[_0x4caab4(0x21b)];});if(_0x5e14bb[_0x3e6af6(0x247)]>0x0)return _0x348e56['json']({'errors':[{'location':_0x3e6af6(0x208),'msg':'Lo\x20sentimos\x20el\x20servidor\x20proxy\x20ya\x20está\x20vinculado\x20a\x20este\x20servidor\x20LDAP'}]});else{if(_0x4fe86f[_0x3e6af6(0x224)]){let _0x44acb2=yield _0x4fe86f[_0x3e6af6(0x224)][_0x3e6af6(0x221)](_0x3e6af6(0x24c))[_0x3e6af6(0x20d)](),_0x3a8253=_0x44acb2[_0x3e6af6(0x24c)][_0x3e6af6(0x1ef)](function(_0x433946){const _0x716b34=_0x3e6af6;return _0x433946[_0x716b34(0x21b)]!=_0x4fe86f[_0x716b34(0x21b)];});_0x44acb2['proxyservers']=_0x3a8253,_0x44acb2[_0x3e6af6(0x1f4)]();}return _0x4fe86f['serverldap']=_0x18e44a[_0x3e6af6(0x24d)],_0x4fe86f[_0x3e6af6(0x1f4)](),_0x18e44a[_0x3e6af6(0x24c)][_0x3e6af6(0x20b)](_0x4fe86f),_0x18e44a['save'](),_0x348e56[_0x3e6af6(0x22e)]({'status':'ok','msg':_0x3e6af6(0x217)});}}}))[_0x178251(0x1fc)](_0x31fd0d=>{const _0x2fa012=_0x178251;return _0x348e56[_0x2fa012(0x22e)]({'errors':[{'location':_0x2fa012(0x21c),'msg':'Lo\x20sentimos\x20no\x20se\x20pudieron\x20obtener\x20los\x20datos\x20del\x20servidor\x20proxy','param':_0x2fa012(0x23a)}]});});}))[_0x4f16c1(0x1fc)](_0x43b9fa=>{const _0x2e5b74=_0x4f16c1;return _0x348e56[_0x2e5b74(0x22e)]({'errors':[{'location':'find\x20ldap\x20server','msg':_0x2e5b74(0x1fb),'param':_0x2e5b74(0x23a)}]});});});exports['linkProxyServer']=linkProxyServer;const getSourceInfo=(_0x50aebb,_0x4cca03)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x59c389=a10_0x17b607;yield Server_1['Server'][_0x59c389(0x226)]({'host':_0x50aebb['body'][_0x59c389(0x21b)]})[_0x59c389(0x221)](_0x59c389(0x224))[_0x59c389(0x21d)](_0x299601=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x3203ac=_0x59c389;if(_0x299601){if(_0x299601[_0x3203ac(0x224)]){const _0x1af912=ldap[_0x3203ac(0x1ee)]({'url':['ldap://'+_0x299601[_0x3203ac(0x224)][_0x3203ac(0x21b)]+':'+_0x299601[_0x3203ac(0x224)][_0x3203ac(0x201)]]});yield _0x1af912[_0x3203ac(0x20f)](_0x299601['serverldap'][_0x3203ac(0x218)],_0x299601[_0x3203ac(0x224)]['password'],_0x16fe0d=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x2790fa=_0x3203ac;if(_0x16fe0d)return _0x1af912[_0x2790fa(0x238)](),_0x1af912['destroy'](),_0x4cca03[_0x2790fa(0x22e)]({'errors':[{'location':_0x2790fa(0x1ff),'msg':_0x2790fa(0x1fe),'param':_0x2790fa(0x23a)}]});else{var _0x18aaec={'filter':'samaccountname='+_0x50aebb[_0x2790fa(0x22c)][_0x2790fa(0x23d)],'scope':_0x2790fa(0x21e)};yield _0x1af912['search'](_0x299601[_0x2790fa(0x224)][_0x2790fa(0x21f)],_0x18aaec,function(_0x1085be,_0x14c084){const _0x12a6cc=_0x2790fa;if(_0x1085be)return _0x1af912[_0x12a6cc(0x238)](),_0x1af912[_0x12a6cc(0x231)](),_0x4cca03['json']({'errors':[{'location':_0x12a6cc(0x1ff),'msg':_0x12a6cc(0x24b),'param':_0x12a6cc(0x23a)}]});else _0x14c084['on'](_0x12a6cc(0x1f1),function(_0x5c9144){const _0x49dcd0=_0x12a6cc;return _0x1af912['unbind'](),_0x1af912['destroy'](),_0x4cca03[_0x49dcd0(0x22e)](_0x5c9144[_0x49dcd0(0x222)]);}),_0x14c084['on'](_0x12a6cc(0x1f5),function(_0x232b0e){const _0x39ac53=_0x12a6cc;return _0x1af912[_0x39ac53(0x238)](),_0x1af912[_0x39ac53(0x231)](),_0x4cca03[_0x39ac53(0x22e)]({'errors':[{'location':'search\x20source','msg':_0x39ac53(0x20e),'param':_0x39ac53(0x23a)}]});});});}}));}else return _0x4cca03['json']({'errors':[{'location':_0x3203ac(0x1f2),'msg':'Lo\x20sentimos\x20el\x20servidor\x20proxy\x20no\x20tiene\x20ningún\x20servidor\x20LDAP\x20asociado','param':_0x3203ac(0x23a)}]});}else return _0x4cca03[_0x3203ac(0x22e)]({'errors':[{'location':_0x3203ac(0x21c),'msg':'Lo\x20sentimos\x20este\x20servidor\x20proxy\x20no\x20se\x20encuentra\x20registrado','param':_0x3203ac(0x23a)}]});}))[_0x59c389(0x1fc)](_0x311633=>{const _0x30a5b8=_0x59c389;return _0x4cca03[_0x30a5b8(0x22e)]({'errors':[{'location':_0x30a5b8(0x21c),'msg':'Lo\x20sentimos\x20no\x20se\x20pudieron\x20obtener\x20los\x20datos\x20del\x20servidor\x20proxy','param':_0x30a5b8(0x23a)}]});});});exports[a10_0x17b607(0x235)]=getSourceInfo;const deleteServer=(_0x48a715,_0x1d09b4)=>{const _0x3e84c8=a10_0x17b607;ServerLdap_1[_0x3e84c8(0x236)][_0x3e84c8(0x22a)](_0x48a715[_0x3e84c8(0x223)]['id'])[_0x3e84c8(0x221)]('proxyservers')[_0x3e84c8(0x21d)](_0x3ff861=>{const _0x87f7e1=_0x3e84c8;if(_0x3ff861)_0x3ff861[_0x87f7e1(0x24c)]!==undefined&&_0x3ff861[_0x87f7e1(0x24c)][_0x87f7e1(0x247)]>0x0&&_0x3ff861['proxyservers'][_0x87f7e1(0x229)]((_0x34fec1,_0x2d041e)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x27ec61=_0x87f7e1;yield Server_1[_0x27ec61(0x1f3)][_0x27ec61(0x209)][_0x27ec61(0x212)]({'_id':_0x34fec1[_0x27ec61(0x24d)]},{'$unset':{'serverldap':0x1}});})),ServerLdap_1['ServerLdap'][_0x87f7e1(0x1f8)](_0x48a715[_0x87f7e1(0x223)]['id'])[_0x87f7e1(0x21d)](()=>{const _0x1ecf4b=_0x87f7e1;return _0x1d09b4[_0x1ecf4b(0x22e)](_0x3ff861);})[_0x87f7e1(0x1fc)](_0x1ff449=>{const _0x51e79b=_0x87f7e1;return _0x1d09b4['json']({'errors':[{'location':_0x51e79b(0x208),'msg':'Lo\x20sentimos\x20no\x20se\x20pudo\x20eliminar\x20el\x20servidor\x20LDAP','param':'connection'}]});});else return _0x1d09b4[_0x87f7e1(0x22e)]({'errors':[{'location':'delete','msg':'Lo\x20sentimos\x20este\x20servidor\x20LDAP\x20no\x20se\x20encuentra\x20registrado','param':_0x87f7e1(0x21b)}]});})[_0x3e84c8(0x1fc)](_0x4c9822=>{const _0x5997bd=_0x3e84c8;return _0x1d09b4['json']({'errors':[{'location':'delete','msg':_0x5997bd(0x1fb),'param':'findserver'}]});});};exports[a10_0x17b607(0x200)]=deleteServer;