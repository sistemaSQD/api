'use strict';const a10_0x4d9adf=a10_0x15ca;(function(_0x2641d2,_0x5c9578){const _0x4bb7e8=a10_0x15ca,_0x1fdcb1=_0x2641d2();while(!![]){try{const _0xd71f48=-parseInt(_0x4bb7e8(0x22f))/0x1+parseInt(_0x4bb7e8(0x239))/0x2+parseInt(_0x4bb7e8(0x223))/0x3*(parseInt(_0x4bb7e8(0x221))/0x4)+-parseInt(_0x4bb7e8(0x240))/0x5*(parseInt(_0x4bb7e8(0x215))/0x6)+-parseInt(_0x4bb7e8(0x1dd))/0x7+-parseInt(_0x4bb7e8(0x23c))/0x8+parseInt(_0x4bb7e8(0x20f))/0x9;if(_0xd71f48===_0x5c9578)break;else _0x1fdcb1['push'](_0x1fdcb1['shift']());}catch(_0x530277){_0x1fdcb1['push'](_0x1fdcb1['shift']());}}}(a10_0x183a,0xa6e1b));var __awaiter=this&&this[a10_0x4d9adf(0x1db)]||function(_0xf3ee80,_0x389fbb,_0x425a49,_0x578b95){function _0x12fe85(_0x571b0a){return _0x571b0a instanceof _0x425a49?_0x571b0a:new _0x425a49(function(_0x214fb0){_0x214fb0(_0x571b0a);});}return new(_0x425a49||(_0x425a49=Promise))(function(_0xd6755b,_0xf7ddfd){const _0xaa84e6=a10_0x15ca;function _0x4f44f5(_0x195a64){const _0x3f6dd9=a10_0x15ca;try{_0xefdaa0(_0x578b95[_0x3f6dd9(0x1df)](_0x195a64));}catch(_0x55b69d){_0xf7ddfd(_0x55b69d);}}function _0x53b17d(_0xa04c8a){const _0x219341=a10_0x15ca;try{_0xefdaa0(_0x578b95[_0x219341(0x1f9)](_0xa04c8a));}catch(_0x104869){_0xf7ddfd(_0x104869);}}function _0xefdaa0(_0x47d620){const _0xf8c43b=a10_0x15ca;_0x47d620['done']?_0xd6755b(_0x47d620[_0xf8c43b(0x227)]):_0x12fe85(_0x47d620[_0xf8c43b(0x227)])['then'](_0x4f44f5,_0x53b17d);}_0xefdaa0((_0x578b95=_0x578b95[_0xaa84e6(0x201)](_0xf3ee80,_0x389fbb||[]))[_0xaa84e6(0x1df)]());});};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a10_0x4d9adf(0x22a)]=exports[a10_0x4d9adf(0x208)]=exports[a10_0x4d9adf(0x1ec)]=exports[a10_0x4d9adf(0x200)]=exports[a10_0x4d9adf(0x1e3)]=void 0x0;const express_validator_1=require(a10_0x4d9adf(0x21d)),ServerLdap_1=require(a10_0x4d9adf(0x1f8)),Server_1=require(a10_0x4d9adf(0x20c)),ldap=require('ldapjs'),getLdapServers=(_0x51d723,_0x1d5f5c)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x28ce59=a10_0x4d9adf;let _0x2de039=yield ServerLdap_1[_0x28ce59(0x1e0)][_0x28ce59(0x206)]()[_0x28ce59(0x1f6)](_0x38da76=>{return _0x38da76;})[_0x28ce59(0x1f1)](_0x5db1bb=>{const _0x5c5232=_0x28ce59;return{'errors':[{'location':_0x5c5232(0x1e3),'msg':_0x5c5232(0x1f2),'param':'servers'}]};});return _0x1d5f5c[_0x28ce59(0x204)](_0x2de039);});exports['getLdapServers']=getLdapServers;const register=(_0x11d8d7,_0x43b31e)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x387e5c=a10_0x4d9adf;yield express_validator_1['check'](_0x387e5c(0x22d))[_0x387e5c(0x22e)]()['withMessage'](_0x387e5c(0x1e7))[_0x387e5c(0x1e8)](_0x11d8d7);const _0x3acd85=_0x455b31=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x4dc56f=_0x387e5c;if(!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/['test'](_0x11d8d7['body'][_0x4dc56f(0x22d)]))return Promise[_0x4dc56f(0x22b)](_0x4dc56f(0x1de));}),_0x3f3ebd=_0x22e09d=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x12e665=_0x387e5c;return yield ServerLdap_1[_0x12e665(0x1e0)][_0x12e665(0x222)]({'host':_0x11d8d7[_0x12e665(0x1ef)]['host']})[_0x12e665(0x1f6)](_0x1e9cbe=>{const _0x2d7fe0=_0x12e665;if(_0x1e9cbe)return Promise[_0x2d7fe0(0x22b)](_0x2d7fe0(0x231));});});yield express_validator_1[_0x387e5c(0x1fd)](_0x387e5c(0x22d))[_0x387e5c(0x1e1)](_0x3acd85)[_0x387e5c(0x1e8)](_0x11d8d7),yield express_validator_1[_0x387e5c(0x1fd)](_0x387e5c(0x22d))['custom'](_0x3f3ebd)['run'](_0x11d8d7);const _0x241b37=express_validator_1[_0x387e5c(0x1e2)](_0x11d8d7);if(!_0x241b37[_0x387e5c(0x23b)]())return _0x43b31e[_0x387e5c(0x224)](0x190)[_0x387e5c(0x204)]({'errors':_0x241b37[_0x387e5c(0x219)]()});const _0x1393f6=ldap[_0x387e5c(0x210)]({'url':['ldap://'+_0x11d8d7[_0x387e5c(0x1ef)][_0x387e5c(0x22d)]+':'+_0x11d8d7['body']['port']],'reconnect':!![]});yield _0x1393f6['bind'](_0x11d8d7[_0x387e5c(0x1ef)][_0x387e5c(0x213)],_0x11d8d7[_0x387e5c(0x1ef)][_0x387e5c(0x23a)],_0x134b9b=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x24a5e8=_0x387e5c;if(_0x134b9b)return _0x43b31e[_0x24a5e8(0x204)]({'errors':[{'location':_0x24a5e8(0x200),'msg':_0x24a5e8(0x229),'param':'savedserver'}]});else yield _0x1393f6[_0x24a5e8(0x23f)](_0x11d8d7['body'][_0x24a5e8(0x216)],{},function(_0x2adefa,_0x3753d5){const _0xc719be=_0x24a5e8;if(_0x2adefa)return _0x43b31e[_0xc719be(0x204)]({'errors':[{'location':'register','msg':'Lo\x20sentimos\x20el\x20Dn\x20Base\x20es\x20incorrecto','param':_0xc719be(0x1d9)}]});else _0x3753d5['on'](_0xc719be(0x203),function(_0x566c32){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x45084a=a10_0x15ca;let _0x1f9a27=new ServerLdap_1[(_0x45084a(0x230))]({'host':_0x11d8d7[_0x45084a(0x1ef)][_0x45084a(0x22d)],'port':_0x11d8d7[_0x45084a(0x1ef)][_0x45084a(0x233)],'dnbase':_0x11d8d7[_0x45084a(0x1ef)]['dnbase'],'dnuser':_0x11d8d7[_0x45084a(0x1ef)]['dnuser'],'encryption':_0x11d8d7['body'][_0x45084a(0x1e9)],'password':_0x11d8d7[_0x45084a(0x1ef)]['password']});return yield ServerLdap_1[_0x45084a(0x1e0)][_0x45084a(0x1dc)](_0x1f9a27,(_0x21b469,_0x50b327)=>{const _0x51714d=_0x45084a;if(_0x21b469)return _0x43b31e[_0x51714d(0x204)]({'errors':[{'location':_0x51714d(0x200),'msg':_0x51714d(0x226),'param':_0x51714d(0x1d9)}]});else return _0x43b31e[_0x51714d(0x204)](_0x50b327);});});}),_0x3753d5['on'](_0xc719be(0x217),function(_0x4b581b){const _0x2d65c6=_0xc719be;return console[_0x2d65c6(0x217)](_0x2d65c6(0x211)+_0x4b581b['message']),_0x43b31e[_0x2d65c6(0x204)]({'errors':[{'location':'register','msg':_0x2d65c6(0x1e5),'param':'savedserver'}]});});});}));});exports['register']=register;function a10_0x15ca(_0x26504c,_0x117eab){const _0x183ae9=a10_0x183a();return a10_0x15ca=function(_0x15ca0b,_0x56c0c2){_0x15ca0b=_0x15ca0b-0x1d9;let _0x4177b3=_0x183ae9[_0x15ca0b];return _0x4177b3;},a10_0x15ca(_0x26504c,_0x117eab);}const linkProxyServer=(_0x559394,_0x3443a7)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0xfaa6e7=a10_0x4d9adf;yield ServerLdap_1[_0xfaa6e7(0x1e0)][_0xfaa6e7(0x220)](_0x559394[_0xfaa6e7(0x1ef)][_0xfaa6e7(0x1f4)])[_0xfaa6e7(0x228)]('proxyservers')[_0xfaa6e7(0x1f6)](_0x5a4476=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x318c85=_0xfaa6e7;yield Server_1[_0x318c85(0x21e)][_0x318c85(0x220)](_0x559394['body']['proxyid'])[_0x318c85(0x228)]('serverldap')[_0x318c85(0x1f6)](_0x32a7be=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x4f7140=_0x318c85;if(_0x559394[_0x4f7140(0x1ef)][_0x4f7140(0x1f4)]==_0x4f7140(0x1ea)){if(_0x32a7be[_0x4f7140(0x1eb)]!==undefined){let _0x2de0b4=yield _0x32a7be[_0x4f7140(0x1eb)][_0x4f7140(0x228)](_0x4f7140(0x1f3))['execPopulate'](),_0x554cfd=_0x2de0b4[_0x4f7140(0x1f3)][_0x4f7140(0x205)](function(_0x5baa67){return _0x5baa67['host']!=_0x32a7be['host'];});return _0x2de0b4[_0x4f7140(0x1f3)]=_0x554cfd,_0x2de0b4[_0x4f7140(0x225)](),yield Server_1[_0x4f7140(0x21e)]['collection'][_0x4f7140(0x1e6)]({'_id':_0x32a7be[_0x4f7140(0x20d)]},{'$unset':{'serverldap':0x1}}),_0x3443a7[_0x4f7140(0x204)]({'status':_0x4f7140(0x21f),'msg':_0x4f7140(0x1ff)});}else return _0x3443a7['json']({'status':_0x4f7140(0x20b),'msg':_0x4f7140(0x218)});}else{let _0x392e44=_0x5a4476[_0x4f7140(0x1f3)][_0x4f7140(0x205)](function(_0x507a6f){const _0x2639d9=_0x4f7140;return _0x507a6f[_0x2639d9(0x22d)]==_0x32a7be['host'];});if(_0x392e44[_0x4f7140(0x20a)]>0x0)return _0x3443a7[_0x4f7140(0x204)]({'errors':[{'location':_0x4f7140(0x21a),'msg':_0x4f7140(0x1ee)}]});else{if(_0x32a7be[_0x4f7140(0x1eb)]){let _0x4b934a=yield _0x32a7be[_0x4f7140(0x1eb)][_0x4f7140(0x228)](_0x4f7140(0x1f3))[_0x4f7140(0x1fb)](),_0x3b77d3=_0x4b934a[_0x4f7140(0x1f3)][_0x4f7140(0x205)](function(_0x2517f7){const _0xc9868a=_0x4f7140;return _0x2517f7[_0xc9868a(0x22d)]!=_0x32a7be[_0xc9868a(0x22d)];});_0x4b934a[_0x4f7140(0x1f3)]=_0x3b77d3,_0x4b934a[_0x4f7140(0x225)]();}return _0x32a7be[_0x4f7140(0x1eb)]=_0x5a4476[_0x4f7140(0x20d)],_0x32a7be[_0x4f7140(0x225)](),_0x5a4476[_0x4f7140(0x1f3)]['push'](_0x32a7be),_0x5a4476[_0x4f7140(0x225)](),_0x3443a7[_0x4f7140(0x204)]({'status':'ok','msg':_0x4f7140(0x23d)});}}}))[_0x318c85(0x1f1)](_0x126f62=>{const _0x5dd427=_0x318c85;return _0x3443a7[_0x5dd427(0x204)]({'errors':[{'location':_0x5dd427(0x21c),'msg':_0x5dd427(0x209),'param':_0x5dd427(0x1fa)}]});});}))[_0xfaa6e7(0x1f1)](_0x3f743d=>{const _0x272e9f=_0xfaa6e7;return _0x3443a7[_0x272e9f(0x204)]({'errors':[{'location':_0x272e9f(0x235),'msg':'Lo\x20sentimos\x20no\x20se\x20pudieron\x20obtener\x20los\x20datos\x20del\x20servidor\x20LDAP','param':_0x272e9f(0x1fa)}]});});});exports[a10_0x4d9adf(0x1ec)]=linkProxyServer;const getSourceInfo=(_0x5c8a50,_0x1fdfb0)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x3cf535=a10_0x4d9adf;yield Server_1[_0x3cf535(0x21e)][_0x3cf535(0x222)]({'host':_0x5c8a50[_0x3cf535(0x1ef)]['host']})[_0x3cf535(0x228)](_0x3cf535(0x1eb))['then'](_0x403e06=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x1561fe=_0x3cf535;if(_0x403e06){if(_0x403e06[_0x1561fe(0x1eb)]){const _0x485ef8=ldap[_0x1561fe(0x210)]({'url':[_0x1561fe(0x1fc)+_0x403e06['serverldap']['host']+':'+_0x403e06[_0x1561fe(0x1eb)][_0x1561fe(0x233)]]});yield _0x485ef8['bind'](_0x403e06['serverldap']['dnuser'],_0x403e06[_0x1561fe(0x1eb)][_0x1561fe(0x23a)],_0x565063=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x5a9c9c=_0x1561fe;if(_0x565063)return _0x485ef8[_0x5a9c9c(0x1f0)](),_0x485ef8['destroy'](),_0x1fdfb0[_0x5a9c9c(0x204)]({'errors':[{'location':_0x5a9c9c(0x212),'msg':_0x5a9c9c(0x229),'param':_0x5a9c9c(0x1fa)}]});else{var _0x825cb5={'filter':_0x5a9c9c(0x1f5)+_0x5c8a50['body'][_0x5a9c9c(0x202)],'scope':'sub'};yield _0x485ef8[_0x5a9c9c(0x23f)](_0x403e06[_0x5a9c9c(0x1eb)]['dnbase'],_0x825cb5,function(_0x1b4a5c,_0x269f60){const _0x342512=_0x5a9c9c;if(_0x1b4a5c)return _0x485ef8['unbind'](),_0x485ef8['destroy'](),_0x1fdfb0[_0x342512(0x204)]({'errors':[{'location':_0x342512(0x212),'msg':_0x342512(0x1fe),'param':_0x342512(0x1fa)}]});else _0x269f60['on'](_0x342512(0x203),function(_0x57e022){const _0x2030ff=_0x342512;return _0x485ef8[_0x2030ff(0x1f0)](),_0x485ef8[_0x2030ff(0x237)](),_0x1fdfb0[_0x2030ff(0x204)](_0x57e022[_0x2030ff(0x234)]);}),_0x269f60['on'](_0x342512(0x217),function(_0x1ed1f2){const _0x23b0a7=_0x342512;return _0x485ef8['unbind'](),_0x485ef8[_0x23b0a7(0x237)](),_0x1fdfb0[_0x23b0a7(0x204)]({'errors':[{'location':_0x23b0a7(0x23e),'msg':_0x23b0a7(0x21b),'param':_0x23b0a7(0x1fa)}]});});});}}));}else return _0x1fdfb0[_0x1561fe(0x204)]({'errors':[{'location':_0x1561fe(0x235),'msg':_0x1561fe(0x207),'param':'servers'}]});}else return _0x1fdfb0[_0x1561fe(0x204)]({'errors':[{'location':_0x1561fe(0x21c),'msg':_0x1561fe(0x22c),'param':'servers'}]});}))['catch'](_0x176b83=>{const _0x4410e2=_0x3cf535;return _0x1fdfb0[_0x4410e2(0x204)]({'errors':[{'location':'find\x20proxy\x20server','msg':_0x4410e2(0x209),'param':_0x4410e2(0x1fa)}]});});});exports[a10_0x4d9adf(0x208)]=getSourceInfo;function a10_0x183a(){const _0x5b612f=['446960cDKUgH','ServerLdapInterface','host_found','connection','port','object','find\x20ldap\x20server','Lo\x20sentimos\x20no\x20se\x20pudieron\x20obtener\x20los\x20datos\x20del\x20servidor\x20LDAP','destroy','delete','1765042VNhJAy','password','isEmpty','4862736wnHCNa','El\x20vinculo\x20ha\x20sido\x20realizado\x20correctamente','search\x20source','search','542480jtzRsC','savedserver','map','__awaiter','create','1219925PFTbDi','host_not_is_ip','next','ServerLdap','custom','validationResult','getLdapServers','findByIdAndDelete','Lo\x20sentimos\x20no\x20se\x20pudo\x20encontrar\x20ninguna\x20entidad\x20en\x20el\x20servidor\x20LDAP','updateOne','host_empty','run','encryption','noldapserver','serverldap','linkProxyServer','findserver','Lo\x20sentimos\x20el\x20servidor\x20proxy\x20ya\x20está\x20vinculado\x20a\x20este\x20servidor\x20LDAP','body','unbind','catch','Lo\x20sentimos\x20no\x20se\x20pudieron\x20obtener\x20los\x20datos\x20de\x20los\x20servidores\x20LDAP','proxyservers','ldapid','samaccountname=','then','Lo\x20sentimos\x20no\x20se\x20pudo\x20eliminar\x20el\x20servidor\x20LDAP','../models/ServerLdap','throw','servers','execPopulate','ldap://','check','Lo\x20sentimos\x20el\x20Dn\x20Base\x20es\x20incorrecto','Servidor\x20LDAP\x20eliminado\x20correctamente','register','apply','source','searchEntry','json','filter','find','Lo\x20sentimos\x20el\x20servidor\x20proxy\x20no\x20tiene\x20ningún\x20servidor\x20LDAP\x20asociado','getSourceInfo','Lo\x20sentimos\x20no\x20se\x20pudieron\x20obtener\x20los\x20datos\x20del\x20servidor\x20proxy','length','nothingtodo','../models/Server','_id','Lo\x20sentimos\x20este\x20servidor\x20LDAP\x20no\x20se\x20encuentra\x20registrado','11073627pedmcv','createClient','error:\x20','auth\x20ldap\x20server','dnuser','collection','48XZFbQD','dnbase','error','Nada\x20que\x20hacer\x20con\x20el\x20servidor\x20ldap','array','update','Lo\x20sentimos\x20no\x20se\x20pudo\x20encontrar\x20la\x20entidad\x20especificada','find\x20proxy\x20server','express-validator','Server','serverldapdeleted','findById','8vawCDY','findOne','1001502zvPsxe','status','save','Lo\x20sentimos\x20no\x20se\x20pudo\x20registrar\x20el\x20servidor\x20LDAP','value','populate','Lo\x20sentimos\x20los\x20datos\x20de\x20autenticación\x20son\x20incorrectos','deleteServer','reject','Lo\x20sentimos\x20este\x20servidor\x20proxy\x20no\x20se\x20encuentra\x20registrado','host','notEmpty'];a10_0x183a=function(){return _0x5b612f;};return a10_0x183a();}const deleteServer=(_0x1c3d1d,_0x1859db)=>{const _0x435a3e=a10_0x4d9adf;ServerLdap_1[_0x435a3e(0x1e0)]['findById'](_0x1c3d1d['params']['id'])[_0x435a3e(0x228)](_0x435a3e(0x1f3))[_0x435a3e(0x1f6)](_0x16df9d=>{const _0x28d513=_0x435a3e;if(_0x16df9d)_0x16df9d[_0x28d513(0x1f3)]!==undefined&&_0x16df9d[_0x28d513(0x1f3)][_0x28d513(0x20a)]>0x0&&_0x16df9d[_0x28d513(0x1f3)][_0x28d513(0x1da)]((_0x4bdc08,_0x44824a)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x3a62ee=_0x28d513;yield Server_1[_0x3a62ee(0x21e)][_0x3a62ee(0x214)][_0x3a62ee(0x1e6)]({'_id':_0x4bdc08['_id']},{'$unset':{'serverldap':0x1}});})),ServerLdap_1['ServerLdap'][_0x28d513(0x1e4)](_0x1c3d1d['params']['id'])[_0x28d513(0x1f6)](()=>{const _0x3ae098=_0x28d513;return _0x1859db[_0x3ae098(0x204)](_0x16df9d);})[_0x28d513(0x1f1)](_0x42fc7a=>{const _0x116298=_0x28d513;return _0x1859db['json']({'errors':[{'location':'update','msg':_0x116298(0x1f7),'param':_0x116298(0x232)}]});});else return _0x1859db[_0x28d513(0x204)]({'errors':[{'location':_0x28d513(0x238),'msg':_0x28d513(0x20e),'param':_0x28d513(0x22d)}]});})[_0x435a3e(0x1f1)](_0x160f16=>{const _0x295387=_0x435a3e;return _0x1859db['json']({'errors':[{'location':'delete','msg':_0x295387(0x236),'param':_0x295387(0x1ed)}]});});};exports[a10_0x4d9adf(0x22a)]=deleteServer;