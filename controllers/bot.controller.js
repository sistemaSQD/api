'use strict';const a76_0xa10c59=a76_0x4837;(function(_0x36a845,_0xd8cf41){const _0x1fdc2a=a76_0x4837,_0x33d013=_0x36a845();while(!![]){try{const _0x20a902=parseInt(_0x1fdc2a(0x9c))/0x1+parseInt(_0x1fdc2a(0x84))/0x2+-parseInt(_0x1fdc2a(0x76))/0x3*(parseInt(_0x1fdc2a(0x95))/0x4)+-parseInt(_0x1fdc2a(0xa5))/0x5+-parseInt(_0x1fdc2a(0x8d))/0x6+parseInt(_0x1fdc2a(0x71))/0x7*(-parseInt(_0x1fdc2a(0x78))/0x8)+-parseInt(_0x1fdc2a(0x6f))/0x9*(-parseInt(_0x1fdc2a(0xb3))/0xa);if(_0x20a902===_0xd8cf41)break;else _0x33d013['push'](_0x33d013['shift']());}catch(_0x464217){_0x33d013['push'](_0x33d013['shift']());}}}(a76_0x4c0e,0xc47ca));var __awaiter=this&&this[a76_0xa10c59(0x97)]||function(_0x29b975,_0x91145b,_0x6b806e,_0x535ab9){function _0x330f77(_0x38841b){return _0x38841b instanceof _0x6b806e?_0x38841b:new _0x6b806e(function(_0x5a64fb){_0x5a64fb(_0x38841b);});}return new(_0x6b806e||(_0x6b806e=Promise))(function(_0x1620f5,_0x55d654){const _0x2ebec9=a76_0x4837;function _0x5871e0(_0x202f84){try{_0x463e4c(_0x535ab9['next'](_0x202f84));}catch(_0x5d4198){_0x55d654(_0x5d4198);}}function _0x259af8(_0x3f5c68){try{_0x463e4c(_0x535ab9['throw'](_0x3f5c68));}catch(_0x485c52){_0x55d654(_0x485c52);}}function _0x463e4c(_0x3b11c2){const _0x4511d2=a76_0x4837;_0x3b11c2[_0x4511d2(0xb1)]?_0x1620f5(_0x3b11c2[_0x4511d2(0x89)]):_0x330f77(_0x3b11c2['value'])['then'](_0x5871e0,_0x259af8);}_0x463e4c((_0x535ab9=_0x535ab9[_0x2ebec9(0x82)](_0x29b975,_0x91145b||[]))[_0x2ebec9(0xb7)]());});};function a76_0x4c0e(){const _0x464c44=['getMe','custom','filter','bot','getBot','pm2\x20restart\x20SQD-bot','save','1421860WhawNN','Proxy','name','telegraf','token','chats','delete','errors','BotInterface','deleteBot','params','reject','done','uri','1444410JdWADd','push','register','update','next','144riebIq','Lo\x20sentimos\x20este\x20ID\x20ya\x20se\x20encuentra\x20registrado','14FqypPh','bot_found','sendMessage','then','bottoken','2037963QfFIMn','run','1455736TgxKfg','findById','proxy-agent','Lo\x20sentimos\x20este\x20bot\x20no\x20se\x20encuentra\x20registrado','pm2\x20stop\x20SQD-bot','../models/Bot','child_process','body','create','Lo\x20sentimos\x20no\x20se\x20pudo\x20eliminar\x20el\x20bot','apply','findOne','638680KWtCKS','__esModule','Telegraf','check','findByIdAndDelete','value','catch','Bot','exec','6530598nWbzJt','defineProperty','registerChat','Lo\x20sentimos\x20no\x20se\x20pudieron\x20obtener\x20los\x20datos\x20del\x20bot','json','withMessage','validationResult','isEmpty','8SHMYot','deleteChat','__awaiter','map','express-validator','telegram','notEmpty','1269795LakGdF','Lo\x20sentimos\x20el\x20token\x20es\x20incorrecto'];a76_0x4c0e=function(){return _0x464c44;};return a76_0x4c0e();}function a76_0x4837(_0x398a37,_0xdb9551){const _0x4c0eac=a76_0x4c0e();return a76_0x4837=function(_0x483728,_0x58c5df){_0x483728=_0x483728-0x6f;let _0x270b50=_0x4c0eac[_0x483728];return _0x270b50;},a76_0x4837(_0x398a37,_0xdb9551);}Object[a76_0xa10c59(0x8e)](exports,a76_0xa10c59(0x85),{'value':!![]}),exports[a76_0xa10c59(0xae)]=exports[a76_0xa10c59(0x96)]=exports[a76_0xa10c59(0x8f)]=exports[a76_0xa10c59(0xb5)]=exports['getBot']=void 0x0;const Bot_1=require(a76_0xa10c59(0x7d)),Proxy_1=require('../models/Proxy'),express_validator_1=require(a76_0xa10c59(0x99)),telegraf_1=require(a76_0xa10c59(0xa8)),exec=require(a76_0xa10c59(0x7e))[a76_0xa10c59(0x8c)],ProxyAgent=require(a76_0xa10c59(0x7a)),getBot=(_0x3a06d0,_0x132315)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x5c0977=a76_0xa10c59;let _0x280210=yield Bot_1[_0x5c0977(0x8b)][_0x5c0977(0x83)]()[_0x5c0977(0x74)](_0x1b2430=>{return _0x1b2430;})[_0x5c0977(0x8a)](_0x5d8d9f=>{const _0x109530=_0x5c0977;return{'errors':[{'location':_0x109530(0xa2),'msg':_0x109530(0x90),'param':_0x109530(0xa1)}]};});return _0x132315[_0x5c0977(0x91)](_0x280210);});exports[a76_0xa10c59(0xa2)]=getBot;const register=(_0x5228d,_0x16b584)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x191705=a76_0xa10c59;yield express_validator_1[_0x191705(0x87)]('bottoken')[_0x191705(0x9b)]()[_0x191705(0x92)]('token_empty')[_0x191705(0x77)](_0x5228d);const _0xad4ec3=_0x49bcb7=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x17a1b9=_0x191705;return Bot_1['Bot']['findOne']()[_0x17a1b9(0x74)](_0x3affc0=>{const _0x1557e3=_0x17a1b9;if(_0x3affc0)return Promise[_0x1557e3(0xb0)](_0x1557e3(0x72));});});yield express_validator_1[_0x191705(0x87)](_0x191705(0x75))[_0x191705(0x9f)](_0xad4ec3)[_0x191705(0x77)](_0x5228d);const _0x261beb=express_validator_1[_0x191705(0x93)](_0x5228d);if(!_0x261beb[_0x191705(0x94)]())return _0x16b584[_0x191705(0x91)]({'errors':_0x261beb['array']()});let _0x4bb49c=yield Proxy_1['Proxy']['findOne']()[_0x191705(0x74)](_0x1139a1=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){return _0x1139a1;}));const _0x46ff11=_0x4bb49c!==null?new ProxyAgent(_0x4bb49c[_0x191705(0xb2)]):null,_0x4a3575=new telegraf_1[(_0x191705(0x86))](_0x5228d['body']['bottoken'],{'telegram':{'agent':_0x46ff11}});yield _0x4a3575['telegram'][_0x191705(0x9e)]()[_0x191705(0x74)](_0xa0aef6=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x577669=_0x191705;let _0x209bb0=new Bot_1[(_0x577669(0xad))]({'token':_0x5228d[_0x577669(0x7f)][_0x577669(0x75)]});yield Bot_1[_0x577669(0x8b)][_0x577669(0x80)](_0x209bb0,(_0x231548,_0x47e3ea)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x24d5ec=_0x577669;if(_0x231548)return _0x16b584[_0x24d5ec(0x91)]({'errors':[{'location':_0x24d5ec(0xb5),'msg':'Lo\x20sentimos\x20no\x20se\x20pudo\x20registrar\x20el\x20bot','param':'create'}]});else{const _0x289fb6=yield execCommand(_0x24d5ec(0xa3));return _0x16b584[_0x24d5ec(0x91)](_0x47e3ea);}}));}))[_0x191705(0x8a)](_0x462b0e=>{const _0x45918a=_0x191705;return _0x16b584['json']({'errors':[{'location':_0x45918a(0xb5),'msg':_0x45918a(0x9d)}]});});});exports['register']=register;const registerChat=(_0x4350ed,_0x43a6bf)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x1c6089=a76_0xa10c59;yield Bot_1[_0x1c6089(0x8b)]['findOne']()[_0x1c6089(0x74)](_0x5e068e=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x484ca0=_0x1c6089;let _0x181dd3=![];_0x5e068e[_0x484ca0(0xaa)][_0x484ca0(0x98)](_0x4e7732=>{const _0x2dc41b=_0x484ca0;if(_0x4e7732['id']==_0x4350ed[_0x2dc41b(0x7f)]['id'])_0x181dd3=!![];});if(!_0x181dd3){let _0x2f9d7d=yield Proxy_1[_0x484ca0(0xa6)]['findOne']()[_0x484ca0(0x74)](_0x285de1=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){return _0x285de1;}));const _0x467156=_0x2f9d7d!==null?new ProxyAgent(_0x2f9d7d['uri']):null,_0x2635ca=new telegraf_1[(_0x484ca0(0x86))](_0x5e068e[_0x484ca0(0xa9)],{'telegram':{'agent':_0x467156}});_0x5e068e[_0x484ca0(0xaa)][_0x484ca0(0xb4)]({'id':_0x4350ed[_0x484ca0(0x7f)]['id'],'name':_0x4350ed[_0x484ca0(0x7f)][_0x484ca0(0xa7)]}),yield _0x5e068e[_0x484ca0(0xa4)]();const _0x16d331=yield execCommand('pm2\x20restart\x20SQD-bot');return _0x2635ca[_0x484ca0(0x9a)][_0x484ca0(0x73)](_0x4350ed[_0x484ca0(0x7f)]['id'],'Listo\x20ya\x20<b>SQD</b>\x20puede\x20atender\x20sus\x20solicitudes,\x20puedes\x20comenzar\x20con\x20el\x20comando\x20/servidores',{'parse_mode':'HTML'}),_0x43a6bf[_0x484ca0(0x91)](_0x5e068e);}return _0x43a6bf[_0x484ca0(0x91)]({'errors':[{'location':_0x484ca0(0x8f),'msg':_0x484ca0(0x70),'param':'chat'}]});}))[_0x1c6089(0x8a)](_0x53e50d=>{const _0x5c1c50=_0x1c6089;return _0x43a6bf[_0x5c1c50(0x91)]({'errors':[{'location':_0x5c1c50(0x8f),'msg':_0x5c1c50(0x90),'param':'findone'}]});});});exports['registerChat']=registerChat;const deleteChat=(_0x2be877,_0x1693f9)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x4ad19c=a76_0xa10c59;yield Bot_1[_0x4ad19c(0x8b)][_0x4ad19c(0x83)]()['then'](_0x386583=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x5663d4=_0x4ad19c;return _0x386583['chats']=_0x386583[_0x5663d4(0xaa)][_0x5663d4(0xa0)](function(_0x273f69){const _0x2c302b=_0x5663d4;return _0x273f69['id']!=_0x2be877[_0x2c302b(0x7f)]['id'];}),yield _0x386583[_0x5663d4(0xa4)](),_0x1693f9[_0x5663d4(0x91)](_0x386583);}))[_0x4ad19c(0x8a)](_0x49ff09=>{const _0x3f8c77=_0x4ad19c;return _0x1693f9[_0x3f8c77(0x91)]({'errors':[{'location':_0x3f8c77(0x96),'msg':_0x3f8c77(0x90),'param':'findone'}]});});});exports[a76_0xa10c59(0x96)]=deleteChat;const deleteBot=(_0x202c15,_0x3fdfcb)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x263ea1=a76_0xa10c59;yield Bot_1['Bot'][_0x263ea1(0x79)](_0x202c15[_0x263ea1(0xaf)]['id'])[_0x263ea1(0x74)](_0x1b54fc=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x59cda9=_0x263ea1;if(_0x1b54fc){const _0x4c4b67=yield execCommand(_0x59cda9(0x7c));Bot_1[_0x59cda9(0x8b)][_0x59cda9(0x88)](_0x202c15[_0x59cda9(0xaf)]['id'])[_0x59cda9(0x74)](()=>{const _0xb560ee=_0x59cda9;return _0x3fdfcb[_0xb560ee(0x91)](_0x1b54fc);})[_0x59cda9(0x8a)](_0x3437de=>{const _0x36206e=_0x59cda9;return _0x3fdfcb[_0x36206e(0x91)]({'errors':[{'location':_0x36206e(0xb6),'msg':_0x36206e(0x81),'param':'connection'}]});});}else return _0x3fdfcb['json']({'errors':[{'location':_0x59cda9(0xab),'msg':_0x59cda9(0x7b),'param':'host'}]});}))[_0x263ea1(0x8a)](_0x447e27=>{const _0x4c0d8b=_0x263ea1;return _0x3fdfcb[_0x4c0d8b(0x91)]({'errors':[{'location':_0x4c0d8b(0xab),'msg':_0x4c0d8b(0x90),'param':'findserver'}]});});});exports[a76_0xa10c59(0xae)]=deleteBot;function execCommand(_0x4ccb31){return new Promise((_0x159d5e,_0x4bde61)=>{exec(_0x4ccb31,(_0x30cfc1,_0x16d839,_0x4ef2cf)=>{const _0x8b6105=a76_0x4837;if(_0x30cfc1||_0x4ef2cf)_0x159d5e(_0x8b6105(0xac));else _0x159d5e(_0x16d839);});});}