'use strict';const a4_0x2147d4=a4_0x17b9;(function(_0x137cea,_0x17970e){const _0x445f50=a4_0x17b9,_0x550c99=_0x137cea();while(!![]){try{const _0xd44422=-parseInt(_0x445f50(0xbe))/0x1*(parseInt(_0x445f50(0xf6))/0x2)+-parseInt(_0x445f50(0xe1))/0x3*(-parseInt(_0x445f50(0xe9))/0x4)+parseInt(_0x445f50(0xc7))/0x5+parseInt(_0x445f50(0xc1))/0x6*(-parseInt(_0x445f50(0xc0))/0x7)+parseInt(_0x445f50(0xe0))/0x8+-parseInt(_0x445f50(0xc9))/0x9*(-parseInt(_0x445f50(0xd0))/0xa)+-parseInt(_0x445f50(0xb8))/0xb;if(_0xd44422===_0x17970e)break;else _0x550c99['push'](_0x550c99['shift']());}catch(_0x33f2e8){_0x550c99['push'](_0x550c99['shift']());}}}(a4_0x32e2,0x41114));var __awaiter=this&&this[a4_0x2147d4(0xdd)]||function(_0x362fa1,_0x504c79,_0x279b17,_0x21973f){function _0x549767(_0x130ad1){return _0x130ad1 instanceof _0x279b17?_0x130ad1:new _0x279b17(function(_0x265965){_0x265965(_0x130ad1);});}return new(_0x279b17||(_0x279b17=Promise))(function(_0x2b77c8,_0x2ce608){const _0x52ccc1=a4_0x17b9;function _0x2bea51(_0x535452){try{_0x5c944e(_0x21973f['next'](_0x535452));}catch(_0x5b4582){_0x2ce608(_0x5b4582);}}function _0x4ea069(_0x2bd20b){const _0x3c3723=a4_0x17b9;try{_0x5c944e(_0x21973f[_0x3c3723(0xb4)](_0x2bd20b));}catch(_0x59d8ee){_0x2ce608(_0x59d8ee);}}function _0x5c944e(_0x51d06d){const _0xea6995=a4_0x17b9;_0x51d06d[_0xea6995(0xe8)]?_0x2b77c8(_0x51d06d[_0xea6995(0xc3)]):_0x549767(_0x51d06d[_0xea6995(0xc3)])['then'](_0x2bea51,_0x4ea069);}_0x5c944e((_0x21973f=_0x21973f[_0x52ccc1(0xd1)](_0x362fa1,_0x504c79||[]))[_0x52ccc1(0xf8)]());});};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a4_0x2147d4(0xcf)]=exports[a4_0x2147d4(0xd6)]=exports['registerChat']=exports[a4_0x2147d4(0xec)]=exports[a4_0x2147d4(0xcd)]=void 0x0;const Bot_1=require(a4_0x2147d4(0xf0)),Proxy_1=require('../models/Proxy'),express_validator_1=require('express-validator'),telegraf_1=require('telegraf'),exec=require(a4_0x2147d4(0xb7))[a4_0x2147d4(0xf1)],ProxyAgent=require(a4_0x2147d4(0xbd)),getBot=(_0x532676,_0xf48f25)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x133f04=a4_0x2147d4;let _0x44b0b3=yield Bot_1[_0x133f04(0xbf)][_0x133f04(0xe5)]()['then'](_0x5a4990=>{return _0x5a4990;})['catch'](_0x44d6ba=>{const _0x517aba=_0x133f04;return{'errors':[{'location':'getBot','msg':_0x517aba(0xd5),'param':'bot'}]};});return _0xf48f25[_0x133f04(0xb6)](_0x44b0b3);});exports[a4_0x2147d4(0xcd)]=getBot;const register=(_0x51a9e9,_0x547206)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x2e8036=a4_0x2147d4;yield express_validator_1[_0x2e8036(0xf3)](_0x2e8036(0xd4))['notEmpty']()[_0x2e8036(0xdc)](_0x2e8036(0xe4))[_0x2e8036(0xcb)](_0x51a9e9);const _0x2e7ef1=_0x1772ed=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x27e203=_0x2e8036;return Bot_1[_0x27e203(0xbf)][_0x27e203(0xe5)]()[_0x27e203(0xc6)](_0x131bb6=>{const _0xd33148=_0x27e203;if(_0x131bb6)return Promise[_0xd33148(0xba)](_0xd33148(0xca));});});yield express_validator_1[_0x2e8036(0xf3)](_0x2e8036(0xd4))[_0x2e8036(0xcc)](_0x2e7ef1)[_0x2e8036(0xcb)](_0x51a9e9);const _0x23a468=express_validator_1['validationResult'](_0x51a9e9);if(!_0x23a468[_0x2e8036(0xd7)]())return _0x547206[_0x2e8036(0xb6)]({'errors':_0x23a468[_0x2e8036(0xd8)]()});let _0x21c25b=yield Proxy_1['Proxy']['findOne']()[_0x2e8036(0xc6)](_0xc5c93b=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){return _0xc5c93b;}));const _0x4125e3=_0x21c25b!==null?new ProxyAgent(_0x21c25b[_0x2e8036(0xee)]):null,_0x52efbc=new telegraf_1[(_0x2e8036(0xdb))](_0x51a9e9[_0x2e8036(0xef)]['bottoken'],{'telegram':{'agent':_0x4125e3}});yield _0x52efbc[_0x2e8036(0xb9)]['getMe']()[_0x2e8036(0xc6)](_0x221483=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x111071=_0x2e8036;let _0x3e087b=new Bot_1['BotInterface']({'token':_0x51a9e9['body'][_0x111071(0xd4)]});yield Bot_1['Bot']['create'](_0x3e087b,(_0x28b0a8,_0x5775d5)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x3f6a1b=_0x111071;if(_0x28b0a8)return _0x547206['json']({'errors':[{'location':_0x3f6a1b(0xec),'msg':'Lo\x20sentimos\x20no\x20se\x20pudo\x20registrar\x20el\x20bot','param':_0x3f6a1b(0xbc)}]});else{const _0x3201c4=yield execCommand('pm2\x20restart\x20SQD-bot');return _0x547206[_0x3f6a1b(0xb6)](_0x5775d5);}}));}))[_0x2e8036(0xe7)](_0x3a788f=>{const _0x329b6f=_0x2e8036;return _0x547206[_0x329b6f(0xb6)]({'errors':[{'location':_0x329b6f(0xec),'msg':_0x329b6f(0xdf)}]});});});function a4_0x17b9(_0x1ac820,_0x40d2c1){const _0x32e2ee=a4_0x32e2();return a4_0x17b9=function(_0x17b98b,_0x2a0ffb){_0x17b98b=_0x17b98b-0xb3;let _0x169db3=_0x32e2ee[_0x17b98b];return _0x169db3;},a4_0x17b9(_0x1ac820,_0x40d2c1);}function a4_0x32e2(){const _0x531530=['filter','throw','Listo\x20ya\x20<b>SQD</b>\x20puede\x20atender\x20sus\x20solicitudes,\x20puedes\x20comenzar\x20con\x20el\x20comando\x20/servidores','json','child_process','1826759POphaa','telegram','reject','Lo\x20sentimos\x20no\x20se\x20pudo\x20eliminar\x20el\x20bot','create','proxy-agent','5jOXbhF','Bot','2952845psWDwc','6JdnwxK','map','value','Lo\x20sentimos\x20este\x20bot\x20no\x20se\x20encuentra\x20registrado','connection','then','1128990HBjcSq','chat','2100069rIAKle','bot_found','run','custom','getBot','token','deleteBot','20VEvqsX','apply','findserver','push','bottoken','Lo\x20sentimos\x20no\x20se\x20pudieron\x20obtener\x20los\x20datos\x20del\x20bot','deleteChat','isEmpty','array','name','errors','Telegraf','withMessage','__awaiter','params','Lo\x20sentimos\x20el\x20token\x20es\x20incorrecto','2113632LNKiVy','2508pfHWkF','delete','findById','token_empty','findOne','Proxy','catch','done','1704DHRmSa','update','findone','register','chats','uri','body','../models/Bot','exec','sendMessage','check','host','Lo\x20sentimos\x20este\x20ID\x20ya\x20se\x20encuentra\x20registrado','183360icaaYq','registerChat','next'];a4_0x32e2=function(){return _0x531530;};return a4_0x32e2();}exports[a4_0x2147d4(0xec)]=register;const registerChat=(_0x4be586,_0x44ba97)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x7cc0b5=a4_0x2147d4;yield Bot_1[_0x7cc0b5(0xbf)][_0x7cc0b5(0xe5)]()['then'](_0x155bd5=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x5c2d5d=_0x7cc0b5;let _0x35b2ae=![];_0x155bd5[_0x5c2d5d(0xed)][_0x5c2d5d(0xc2)](_0x1e7b0d=>{const _0x1b193c=_0x5c2d5d;if(_0x1e7b0d['id']==_0x4be586[_0x1b193c(0xef)]['id'])_0x35b2ae=!![];});if(!_0x35b2ae){let _0x2eccb6=yield Proxy_1[_0x5c2d5d(0xe6)][_0x5c2d5d(0xe5)]()['then'](_0x57e8a8=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){return _0x57e8a8;}));const _0x225357=_0x2eccb6!==null?new ProxyAgent(_0x2eccb6[_0x5c2d5d(0xee)]):null,_0x498886=new telegraf_1[(_0x5c2d5d(0xdb))](_0x155bd5[_0x5c2d5d(0xce)],{'telegram':{'agent':_0x225357}});_0x155bd5[_0x5c2d5d(0xed)][_0x5c2d5d(0xd3)]({'id':_0x4be586[_0x5c2d5d(0xef)]['id'],'name':_0x4be586['body'][_0x5c2d5d(0xd9)]}),yield _0x155bd5['save']();const _0x234bf9=yield execCommand('pm2\x20restart\x20SQD-bot');return _0x498886[_0x5c2d5d(0xb9)][_0x5c2d5d(0xf2)](_0x4be586[_0x5c2d5d(0xef)]['id'],_0x5c2d5d(0xb5),{'parse_mode':'HTML'}),_0x44ba97[_0x5c2d5d(0xb6)](_0x155bd5);}return _0x44ba97[_0x5c2d5d(0xb6)]({'errors':[{'location':'registerChat','msg':_0x5c2d5d(0xf5),'param':_0x5c2d5d(0xc8)}]});}))[_0x7cc0b5(0xe7)](_0x309106=>{const _0x532e1d=_0x7cc0b5;return _0x44ba97[_0x532e1d(0xb6)]({'errors':[{'location':_0x532e1d(0xf7),'msg':_0x532e1d(0xd5),'param':_0x532e1d(0xeb)}]});});});exports[a4_0x2147d4(0xf7)]=registerChat;const deleteChat=(_0x2be2d0,_0x100467)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x17b7f3=a4_0x2147d4;yield Bot_1[_0x17b7f3(0xbf)][_0x17b7f3(0xe5)]()[_0x17b7f3(0xc6)](_0x328bc5=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x404f03=_0x17b7f3;return _0x328bc5[_0x404f03(0xed)]=_0x328bc5['chats'][_0x404f03(0xb3)](function(_0x25d0e3){const _0x4154fe=_0x404f03;return _0x25d0e3['id']!=_0x2be2d0[_0x4154fe(0xef)]['id'];}),yield _0x328bc5['save'](),_0x100467[_0x404f03(0xb6)](_0x328bc5);}))['catch'](_0x35d941=>{const _0x270f2e=_0x17b7f3;return _0x100467[_0x270f2e(0xb6)]({'errors':[{'location':_0x270f2e(0xd6),'msg':'Lo\x20sentimos\x20no\x20se\x20pudieron\x20obtener\x20los\x20datos\x20del\x20bot','param':_0x270f2e(0xeb)}]});});});exports[a4_0x2147d4(0xd6)]=deleteChat;const deleteBot=(_0x3a1975,_0x22d3ce)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x245b67=a4_0x2147d4;yield Bot_1[_0x245b67(0xbf)][_0x245b67(0xe3)](_0x3a1975['params']['id'])[_0x245b67(0xc6)](_0x2be1e5=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){const _0x375141=_0x245b67;if(_0x2be1e5){const _0x5e1d8a=yield execCommand('pm2\x20stop\x20SQD-bot');Bot_1[_0x375141(0xbf)]['findByIdAndDelete'](_0x3a1975[_0x375141(0xde)]['id'])[_0x375141(0xc6)](()=>{const _0x114fab=_0x375141;return _0x22d3ce[_0x114fab(0xb6)](_0x2be1e5);})[_0x375141(0xe7)](_0x50b866=>{const _0x24cf2b=_0x375141;return _0x22d3ce['json']({'errors':[{'location':_0x24cf2b(0xea),'msg':_0x24cf2b(0xbb),'param':_0x24cf2b(0xc5)}]});});}else return _0x22d3ce[_0x375141(0xb6)]({'errors':[{'location':_0x375141(0xe2),'msg':_0x375141(0xc4),'param':_0x375141(0xf4)}]});}))[_0x245b67(0xe7)](_0x3e397c=>{const _0x5e1bb8=_0x245b67;return _0x22d3ce[_0x5e1bb8(0xb6)]({'errors':[{'location':_0x5e1bb8(0xe2),'msg':_0x5e1bb8(0xd5),'param':_0x5e1bb8(0xd2)}]});});});exports['deleteBot']=deleteBot;function execCommand(_0x2f5f73){return new Promise((_0x33972f,_0x34d1a9)=>{exec(_0x2f5f73,(_0x3bc7df,_0x32fbbd,_0x16b0ef)=>{const _0x3e14d2=a4_0x17b9;if(_0x3bc7df||_0x16b0ef)_0x33972f(_0x3e14d2(0xda));else _0x33972f(_0x32fbbd);});});}